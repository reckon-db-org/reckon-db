<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 580">
  <defs>
    <linearGradient id="proberMainGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4299e1"/>
      <stop offset="100%" style="stop-color:#3182ce"/>
    </linearGradient>
    <linearGradient id="healthyNodeGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#48bb78"/>
      <stop offset="100%" style="stop-color:#38a169"/>
    </linearGradient>
    <linearGradient id="suspectNodeGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f6ad55"/>
      <stop offset="100%" style="stop-color:#ed8936"/>
    </linearGradient>
    <linearGradient id="failedNodeGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#fc8181"/>
      <stop offset="100%" style="stop-color:#e53e3e"/>
    </linearGradient>
    <linearGradient id="timelineGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#e2e8f0"/>
      <stop offset="100%" style="stop-color:#cbd5e0"/>
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="900" height="580" fill="#f7fafc"/>

  <!-- Title -->
  <text x="450" y="35" text-anchor="middle" font-family="system-ui, sans-serif" font-size="20" font-weight="bold" fill="#2d3748">Active Health Probing</text>

  <!-- Health Prober Box -->
  <rect x="350" y="55" width="200" height="80" rx="10" fill="url(#proberMainGrad)" stroke="#2b6cb0" stroke-width="2"/>
  <text x="450" y="85" text-anchor="middle" font-family="system-ui, sans-serif" font-size="13" font-weight="bold" fill="white">reckon_db_health_prober</text>
  <text x="450" y="105" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="rgba(255,255,255,0.9)">Interval: 2000ms</text>
  <text x="450" y="120" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="rgba(255,255,255,0.9)">Threshold: 3 failures</text>

  <!-- Probe Type Selection -->
  <rect x="50" y="60" width="250" height="75" rx="8" fill="#edf2f7" stroke="#cbd5e0" stroke-width="1"/>
  <text x="175" y="82" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" font-weight="bold" fill="#4a5568">Probe Types</text>

  <rect x="65" y="95" width="65" height="30" rx="4" fill="white" stroke="#48bb78" stroke-width="1"/>
  <text x="97" y="114" text-anchor="middle" font-family="monospace" font-size="10" fill="#276749">ping</text>

  <rect x="140" y="95" width="65" height="30" rx="4" fill="url(#proberMainGrad)" stroke="#2b6cb0" stroke-width="2"/>
  <text x="172" y="114" text-anchor="middle" font-family="monospace" font-size="10" fill="white">rpc</text>

  <rect x="215" y="95" width="70" height="30" rx="4" fill="white" stroke="#9f7aea" stroke-width="1"/>
  <text x="250" y="114" text-anchor="middle" font-family="monospace" font-size="10" fill="#6b46c1">khepri</text>

  <!-- Config Box -->
  <rect x="600" y="60" width="250" height="75" rx="8" fill="#edf2f7" stroke="#cbd5e0" stroke-width="1"/>
  <text x="725" y="82" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" font-weight="bold" fill="#4a5568">Configuration</text>
  <text x="620" y="102" font-family="monospace" font-size="9" fill="#4a5568">probe_interval: 2000ms</text>
  <text x="620" y="116" font-family="monospace" font-size="9" fill="#4a5568">probe_timeout: 1000ms</text>
  <text x="620" y="130" font-family="monospace" font-size="9" fill="#4a5568">failure_threshold: 3</text>

  <!-- Cluster Nodes Section -->
  <rect x="50" y="160" width="800" height="200" rx="10" fill="white" stroke="#e2e8f0" stroke-width="2"/>
  <text x="450" y="185" text-anchor="middle" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" fill="#4a5568">Cluster Nodes</text>

  <!-- Node 1 - Healthy -->
  <rect x="100" y="205" width="180" height="130" rx="8" fill="#f0fff4" stroke="#9ae6b4" stroke-width="2"/>
  <circle cx="190" cy="250" r="30" fill="url(#healthyNodeGrad)" stroke="#276749" stroke-width="2"/>
  <text x="190" y="255" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" fill="white">Node 1</text>
  <rect x="115" y="290" width="150" height="35" rx="4" fill="white" stroke="#9ae6b4" stroke-width="1"/>
  <text x="190" y="305" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" font-weight="bold" fill="#276749">healthy</text>
  <text x="190" y="318" text-anchor="middle" font-family="monospace" font-size="8" fill="#48bb78">failures: 0</text>

  <!-- Probe arrows to Node 1 -->
  <line x1="450" y1="135" x2="220" y2="220" stroke="#48bb78" stroke-width="2" stroke-dasharray="4"/>
  <text x="280" y="170" font-family="system-ui, sans-serif" font-size="9" fill="#48bb78">OK</text>

  <!-- Node 2 - Suspect -->
  <rect x="360" y="205" width="180" height="130" rx="8" fill="#feebc8" stroke="#f6ad55" stroke-width="2"/>
  <circle cx="450" cy="250" r="30" fill="url(#suspectNodeGrad)" stroke="#dd6b20" stroke-width="2"/>
  <text x="450" y="255" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" fill="white">Node 2</text>
  <rect x="375" y="290" width="150" height="35" rx="4" fill="white" stroke="#f6ad55" stroke-width="1"/>
  <text x="450" y="305" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" font-weight="bold" fill="#c05621">suspect</text>
  <text x="450" y="318" text-anchor="middle" font-family="monospace" font-size="8" fill="#ed8936">failures: 2</text>

  <!-- Probe arrows to Node 2 -->
  <line x1="450" y1="135" x2="450" y2="220" stroke="#f6ad55" stroke-width="2" stroke-dasharray="4"/>
  <text x="460" y="180" font-family="system-ui, sans-serif" font-size="9" fill="#ed8936">FAIL</text>

  <!-- Node 3 - Failed -->
  <rect x="620" y="205" width="180" height="130" rx="8" fill="#fed7d7" stroke="#fc8181" stroke-width="2"/>
  <circle cx="710" cy="250" r="30" fill="url(#failedNodeGrad)" stroke="#c53030" stroke-width="2"/>
  <text x="710" y="255" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" fill="white">Node 3</text>
  <rect x="635" y="290" width="150" height="35" rx="4" fill="white" stroke="#fc8181" stroke-width="1"/>
  <text x="710" y="305" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" font-weight="bold" fill="#c53030">failed</text>
  <text x="710" y="318" text-anchor="middle" font-family="monospace" font-size="8" fill="#e53e3e">failures: 5</text>

  <!-- Probe arrows to Node 3 -->
  <line x1="450" y1="135" x2="680" y2="220" stroke="#fc8181" stroke-width="2" stroke-dasharray="4"/>
  <text x="600" y="170" font-family="system-ui, sans-serif" font-size="9" fill="#e53e3e">FAIL</text>

  <!-- Timeline Section -->
  <rect x="50" y="380" width="800" height="180" rx="10" fill="#edf2f7" stroke="#cbd5e0" stroke-width="1"/>
  <text x="450" y="405" text-anchor="middle" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" fill="#4a5568">Failure Detection Timeline (Node 3)</text>

  <!-- Timeline base -->
  <line x1="80" y1="480" x2="820" y2="480" stroke="#a0aec0" stroke-width="3"/>

  <!-- Time markers -->
  <line x1="120" y1="475" x2="120" y2="485" stroke="#4a5568" stroke-width="2"/>
  <text x="120" y="500" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#718096">0s</text>

  <line x1="250" y1="475" x2="250" y2="485" stroke="#4a5568" stroke-width="2"/>
  <text x="250" y="500" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#718096">2s</text>

  <line x1="380" y1="475" x2="380" y2="485" stroke="#4a5568" stroke-width="2"/>
  <text x="380" y="500" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#718096">4s</text>

  <line x1="510" y1="475" x2="510" y2="485" stroke="#4a5568" stroke-width="2"/>
  <text x="510" y="500" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#718096">6s</text>

  <line x1="640" y1="475" x2="640" y2="485" stroke="#4a5568" stroke-width="2"/>
  <text x="640" y="500" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#718096">8s</text>

  <line x1="770" y1="475" x2="770" y2="485" stroke="#4a5568" stroke-width="2"/>
  <text x="770" y="500" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#718096">10s</text>

  <!-- Probe events -->
  <circle cx="120" cy="450" r="12" fill="#48bb78"/>
  <text x="120" y="454" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="white">1</text>
  <text x="120" y="430" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#48bb78">OK</text>

  <circle cx="250" cy="450" r="12" fill="#fc8181"/>
  <text x="250" y="454" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="white">2</text>
  <text x="250" y="430" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#e53e3e">FAIL 1</text>

  <circle cx="380" cy="450" r="12" fill="#fc8181"/>
  <text x="380" y="454" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="white">3</text>
  <text x="380" y="430" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#e53e3e">FAIL 2</text>

  <circle cx="510" cy="450" r="12" fill="#fc8181"/>
  <text x="510" y="454" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="white">4</text>
  <text x="510" y="430" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#e53e3e">FAIL 3</text>

  <!-- Threshold indicator -->
  <line x1="510" y1="440" x2="510" y2="520" stroke="#c53030" stroke-width="2" stroke-dasharray="3"/>
  <rect x="460" y="510" width="100" height="25" rx="4" fill="url(#failedNodeGrad)" stroke="#c53030" stroke-width="1"/>
  <text x="510" y="527" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="white">FAILED!</text>

  <!-- Callback arrow -->
  <path d="M 560 522 L 640 522 L 640 540" stroke="#c53030" stroke-width="2" marker-end="url(#arrowhead2)"/>
  <rect x="590" y="540" width="180" height="30" rx="4" fill="white" stroke="#c53030" stroke-width="1"/>
  <text x="680" y="560" text-anchor="middle" font-family="monospace" font-size="9" fill="#c53030">on_node_failed callback</text>

  <!-- Status legend -->
  <rect x="80" y="515" width="350" height="35" rx="4" fill="white" stroke="#e2e8f0" stroke-width="1"/>
  <circle cx="110" cy="532" r="8" fill="#48bb78"/>
  <text x="130" y="536" font-family="system-ui, sans-serif" font-size="10" fill="#4a5568">healthy</text>
  <circle cx="190" cy="532" r="8" fill="#f6ad55"/>
  <text x="210" y="536" font-family="system-ui, sans-serif" font-size="10" fill="#4a5568">suspect</text>
  <circle cx="280" cy="532" r="8" fill="#fc8181"/>
  <text x="300" y="536" font-family="system-ui, sans-serif" font-size="10" fill="#4a5568">failed</text>
  <text x="370" y="536" font-family="system-ui, sans-serif" font-size="9" fill="#718096">(threshold=3)</text>

  <!-- Arrowhead marker -->
  <defs>
    <marker id="arrowhead2" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#c53030"/>
    </marker>
  </defs>
</svg>
