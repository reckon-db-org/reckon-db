<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.38.2">
    <meta name="project" content="reckon_db v1.0.0">


    <title>Configuration â€” reckon_db v1.0.0</title>

    <link rel="stylesheet" href="dist/html-erlang-DQDXQC7W.css" />

    <script defer src="dist/sidebar_items-8BBF0070.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-DPJLHKSM.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

      <div>
        <a href="readme.html" class="sidebar-projectName" translate="no">
reckon_db
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v1.0.0
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras=""></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of reckon_db</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>Configuration Guide</h1>


      <a href="https://github.com/reckon-db-org/reckon-db/blob/v1.0.0/guides/configuration.md#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>


<p>This guide covers all configuration options for reckon-db, with examples for both Erlang (sys.config) and Elixir (config.exs).</p><h2 id="quick-start" class="section-heading"><a href="#quick-start" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Quick Start</span></h2><h3 id="erlang-sys-config" class="section-heading"><a href="#erlang-sys-config" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Erlang (sys.config)</span></h3><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="9330562768-1">[</span><span class="w">
  </span><span class="p" data-group-id="9330562768-2">{</span><span class="ss">reckon_db</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9330562768-3">[</span><span class="w">
    </span><span class="p" data-group-id="9330562768-4">{</span><span class="ss">stores</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9330562768-5">[</span><span class="w">
      </span><span class="p" data-group-id="9330562768-6">{</span><span class="ss">my_store</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9330562768-7">[</span><span class="w">
        </span><span class="p" data-group-id="9330562768-8">{</span><span class="ss">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/var/lib/reckon_db/my_store&quot;</span><span class="p" data-group-id="9330562768-8">}</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="9330562768-9">{</span><span class="ss">mode</span><span class="p">,</span><span class="w"> </span><span class="ss">single</span><span class="p" data-group-id="9330562768-9">}</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="9330562768-10">{</span><span class="ss">timeout</span><span class="p">,</span><span class="w"> </span><span class="mi">5000</span><span class="p" data-group-id="9330562768-10">}</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="9330562768-11">{</span><span class="ss">writer_pool_size</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p" data-group-id="9330562768-11">}</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="9330562768-12">{</span><span class="ss">reader_pool_size</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p" data-group-id="9330562768-12">}</span><span class="w">
      </span><span class="p" data-group-id="9330562768-7">]</span><span class="p" data-group-id="9330562768-6">}</span><span class="w">
    </span><span class="p" data-group-id="9330562768-5">]</span><span class="p" data-group-id="9330562768-4">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="9330562768-13">{</span><span class="ss">telemetry_handlers</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9330562768-14">[</span><span class="ss">logger</span><span class="p" data-group-id="9330562768-14">]</span><span class="p" data-group-id="9330562768-13">}</span><span class="w">
  </span><span class="p" data-group-id="9330562768-3">]</span><span class="p" data-group-id="9330562768-2">}</span><span class="w">
</span><span class="p" data-group-id="9330562768-1">]</span><span class="p">.</span></code></pre><h3 id="elixir-config-exs" class="section-heading"><a href="#elixir-config-exs" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Elixir (config.exs)</span></h3><pre><code class="makeup elixir" translate="no"><span class="n">config</span><span class="w"> </span><span class="ss">:reckon_db</span><span class="p">,</span><span class="w">
  </span><span class="ss">stores</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9022131284-1">[</span><span class="w">
    </span><span class="ss">my_store</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9022131284-2">[</span><span class="w">
      </span><span class="ss">data_dir</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/var/lib/reckon_db/my_store&quot;</span><span class="p">,</span><span class="w">
      </span><span class="ss">mode</span><span class="p">:</span><span class="w"> </span><span class="ss">:single</span><span class="p">,</span><span class="w">
      </span><span class="ss">timeout</span><span class="p">:</span><span class="w"> </span><span class="mi">5_000</span><span class="p">,</span><span class="w">
      </span><span class="ss">writer_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
      </span><span class="ss">reader_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
    </span><span class="p" data-group-id="9022131284-2">]</span><span class="w">
  </span><span class="p" data-group-id="9022131284-1">]</span><span class="p">,</span><span class="w">
  </span><span class="ss">telemetry_handlers</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9022131284-3">[</span><span class="ss">:logger</span><span class="p" data-group-id="9022131284-3">]</span></code></pre><h2 id="configuration-reference" class="section-heading"><a href="#configuration-reference" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Configuration Reference</span></h2><h3 id="store-configuration" class="section-heading"><a href="#store-configuration" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Store Configuration</span></h3><p>Stores are the primary configuration. Each store is an independent event store instance backed by Khepri/Ra.</p><table><thead><tr><th style="text-align: left;">Option</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Description</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">stores</code></td><td style="text-align: left;">proplist</td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">List of store configurations</td></tr></tbody></table><p>Each store in the list has:</p><table><thead><tr><th style="text-align: left;">Option</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Description</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">data_dir</code></td><td style="text-align: left;">string</td><td style="text-align: left;"><code class="inline">/var/lib/reckon_db/{store_id}</code></td><td style="text-align: left;">Data directory for Khepri/Ra</td></tr><tr><td style="text-align: left;"><code class="inline">mode</code></td><td style="text-align: left;">atom</td><td style="text-align: left;"><code class="inline">single</code></td><td style="text-align: left;">Operation mode: <code class="inline">single</code> or <code class="inline">cluster</code></td></tr><tr><td style="text-align: left;"><code class="inline">timeout</code></td><td style="text-align: left;">integer</td><td style="text-align: left;">5000</td><td style="text-align: left;">Default timeout in milliseconds</td></tr><tr><td style="text-align: left;"><code class="inline">writer_pool_size</code></td><td style="text-align: left;">integer</td><td style="text-align: left;">10</td><td style="text-align: left;">Number of writer workers</td></tr><tr><td style="text-align: left;"><code class="inline">reader_pool_size</code></td><td style="text-align: left;">integer</td><td style="text-align: left;">10</td><td style="text-align: left;">Number of reader workers</td></tr><tr><td style="text-align: left;"><code class="inline">gateway_pool_size</code></td><td style="text-align: left;">integer</td><td style="text-align: left;">1</td><td style="text-align: left;">Number of gateway workers</td></tr></tbody></table><h4>Erlang Example</h4><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="0066042562-1">{</span><span class="ss">stores</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0066042562-2">[</span><span class="w">
  </span><span class="p" data-group-id="0066042562-3">{</span><span class="ss">orders_store</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0066042562-4">[</span><span class="w">
    </span><span class="p" data-group-id="0066042562-5">{</span><span class="ss">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/bulk0/reckon_db/orders&quot;</span><span class="p" data-group-id="0066042562-5">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="0066042562-6">{</span><span class="ss">mode</span><span class="p">,</span><span class="w"> </span><span class="ss">cluster</span><span class="p" data-group-id="0066042562-6">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="0066042562-7">{</span><span class="ss">timeout</span><span class="p">,</span><span class="w"> </span><span class="mi">10000</span><span class="p" data-group-id="0066042562-7">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="0066042562-8">{</span><span class="ss">writer_pool_size</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p" data-group-id="0066042562-8">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="0066042562-9">{</span><span class="ss">reader_pool_size</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p" data-group-id="0066042562-9">}</span><span class="w">
  </span><span class="p" data-group-id="0066042562-4">]</span><span class="p" data-group-id="0066042562-3">}</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="0066042562-10">{</span><span class="ss">users_store</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0066042562-11">[</span><span class="w">
    </span><span class="p" data-group-id="0066042562-12">{</span><span class="ss">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/bulk0/reckon_db/users&quot;</span><span class="p" data-group-id="0066042562-12">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="0066042562-13">{</span><span class="ss">mode</span><span class="p">,</span><span class="w"> </span><span class="ss">single</span><span class="p" data-group-id="0066042562-13">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="0066042562-14">{</span><span class="ss">writer_pool_size</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p" data-group-id="0066042562-14">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="0066042562-15">{</span><span class="ss">reader_pool_size</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p" data-group-id="0066042562-15">}</span><span class="w">
  </span><span class="p" data-group-id="0066042562-11">]</span><span class="p" data-group-id="0066042562-10">}</span><span class="w">
</span><span class="p" data-group-id="0066042562-2">]</span><span class="p" data-group-id="0066042562-1">}</span></code></pre><h4>Elixir Example</h4><pre><code class="makeup elixir" translate="no"><span class="n">config</span><span class="w"> </span><span class="ss">:reckon_db</span><span class="p">,</span><span class="w">
  </span><span class="ss">stores</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="6094176877-1">[</span><span class="w">
    </span><span class="ss">orders_store</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="6094176877-2">[</span><span class="w">
      </span><span class="ss">data_dir</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/bulk0/reckon_db/orders&quot;</span><span class="p">,</span><span class="w">
      </span><span class="ss">mode</span><span class="p">:</span><span class="w"> </span><span class="ss">:cluster</span><span class="p">,</span><span class="w">
      </span><span class="ss">timeout</span><span class="p">:</span><span class="w"> </span><span class="mi">10_000</span><span class="p">,</span><span class="w">
      </span><span class="ss">writer_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
      </span><span class="ss">reader_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="w">
    </span><span class="p" data-group-id="6094176877-2">]</span><span class="p">,</span><span class="w">
    </span><span class="ss">users_store</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="6094176877-3">[</span><span class="w">
      </span><span class="ss">data_dir</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/bulk0/reckon_db/users&quot;</span><span class="p">,</span><span class="w">
      </span><span class="ss">mode</span><span class="p">:</span><span class="w"> </span><span class="ss">:single</span><span class="p">,</span><span class="w">
      </span><span class="ss">writer_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
      </span><span class="ss">reader_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
    </span><span class="p" data-group-id="6094176877-3">]</span><span class="w">
  </span><span class="p" data-group-id="6094176877-1">]</span></code></pre><h3 id="pool-sizes-global-defaults" class="section-heading"><a href="#pool-sizes-global-defaults" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Pool Sizes (Global Defaults)</span></h3><p>These set defaults for all stores that don't specify their own values.</p><table><thead><tr><th style="text-align: left;">Option</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Description</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">writer_pool_size</code></td><td style="text-align: left;">integer</td><td style="text-align: left;">10</td><td style="text-align: left;">Default writer pool size</td></tr><tr><td style="text-align: left;"><code class="inline">reader_pool_size</code></td><td style="text-align: left;">integer</td><td style="text-align: left;">10</td><td style="text-align: left;">Default reader pool size</td></tr><tr><td style="text-align: left;"><code class="inline">gateway_pool_size</code></td><td style="text-align: left;">integer</td><td style="text-align: left;">1</td><td style="text-align: left;">Default gateway pool size</td></tr></tbody></table><h4>Erlang Example</h4><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="6293782141-1">{</span><span class="ss">writer_pool_size</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p" data-group-id="6293782141-1">}</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="6293782141-2">{</span><span class="ss">reader_pool_size</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p" data-group-id="6293782141-2">}</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="6293782141-3">{</span><span class="ss">gateway_pool_size</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="6293782141-3">}</span></code></pre><h4>Elixir Example</h4><pre><code class="makeup elixir" translate="no"><span class="n">config</span><span class="w"> </span><span class="ss">:reckon_db</span><span class="p">,</span><span class="w">
  </span><span class="ss">writer_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
  </span><span class="ss">reader_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w">
  </span><span class="ss">gateway_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span></code></pre><h3 id="worker-timeouts" class="section-heading"><a href="#worker-timeouts" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Worker Timeouts</span></h3><p>Idle timeout for reader and writer workers.</p><table><thead><tr><th style="text-align: left;">Option</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Description</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">reader_idle_timeout_ms</code></td><td style="text-align: left;">integer</td><td style="text-align: left;">60000</td><td style="text-align: left;">Reader idle timeout (ms)</td></tr><tr><td style="text-align: left;"><code class="inline">writer_idle_timeout_ms</code></td><td style="text-align: left;">integer</td><td style="text-align: left;">60000</td><td style="text-align: left;">Writer idle timeout (ms)</td></tr></tbody></table><h4>Erlang Example</h4><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="0934656998-1">{</span><span class="ss">reader_idle_timeout_ms</span><span class="p">,</span><span class="w"> </span><span class="mi">120000</span><span class="p" data-group-id="0934656998-1">}</span><span class="p">,</span><span class="w">  </span><span class="c1">%% 2 minutes</span><span class="w">
</span><span class="p" data-group-id="0934656998-2">{</span><span class="ss">writer_idle_timeout_ms</span><span class="p">,</span><span class="w"> </span><span class="mi">120000</span><span class="p" data-group-id="0934656998-2">}</span></code></pre><h4>Elixir Example</h4><pre><code class="makeup elixir" translate="no"><span class="n">config</span><span class="w"> </span><span class="ss">:reckon_db</span><span class="p">,</span><span class="w">
  </span><span class="ss">reader_idle_timeout_ms</span><span class="p">:</span><span class="w"> </span><span class="mi">120_000</span><span class="p">,</span><span class="w">
  </span><span class="ss">writer_idle_timeout_ms</span><span class="p">:</span><span class="w"> </span><span class="mi">120_000</span></code></pre><h3 id="health-probing" class="section-heading"><a href="#health-probing" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Health Probing</span></h3><p>Health probing monitors store nodes and triggers failover in cluster mode.</p><table><thead><tr><th style="text-align: left;">Option</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Description</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">health_probe_interval</code></td><td style="text-align: left;">integer</td><td style="text-align: left;">5000</td><td style="text-align: left;">Probe interval in milliseconds</td></tr><tr><td style="text-align: left;"><code class="inline">health_probe_timeout</code></td><td style="text-align: left;">integer</td><td style="text-align: left;">2000</td><td style="text-align: left;">Probe timeout in milliseconds</td></tr><tr><td style="text-align: left;"><code class="inline">health_failure_threshold</code></td><td style="text-align: left;">integer</td><td style="text-align: left;">3</td><td style="text-align: left;">Failures before marking unhealthy</td></tr><tr><td style="text-align: left;"><code class="inline">health_probe_type</code></td><td style="text-align: left;">atom</td><td style="text-align: left;"><code class="inline">ping</code></td><td style="text-align: left;">Probe type: <code class="inline">ping</code> or <code class="inline">deep</code></td></tr></tbody></table><p><strong>Probe Types:</strong></p><ul><li><code class="inline">ping</code> - Simple node reachability check (fast, low overhead)</li><li><code class="inline">deep</code> - Checks Khepri/Ra cluster health (thorough, higher overhead)</li></ul><h4>Erlang Example</h4><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="8716741882-1">{</span><span class="ss">health_probe_interval</span><span class="p">,</span><span class="w"> </span><span class="mi">10000</span><span class="p" data-group-id="8716741882-1">}</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="8716741882-2">{</span><span class="ss">health_probe_timeout</span><span class="p">,</span><span class="w"> </span><span class="mi">5000</span><span class="p" data-group-id="8716741882-2">}</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="8716741882-3">{</span><span class="ss">health_failure_threshold</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p" data-group-id="8716741882-3">}</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="8716741882-4">{</span><span class="ss">health_probe_type</span><span class="p">,</span><span class="w"> </span><span class="ss">deep</span><span class="p" data-group-id="8716741882-4">}</span></code></pre><h4>Elixir Example</h4><pre><code class="makeup elixir" translate="no"><span class="n">config</span><span class="w"> </span><span class="ss">:reckon_db</span><span class="p">,</span><span class="w">
  </span><span class="ss">health_probe_interval</span><span class="p">:</span><span class="w"> </span><span class="mi">10_000</span><span class="p">,</span><span class="w">
  </span><span class="ss">health_probe_timeout</span><span class="p">:</span><span class="w"> </span><span class="mi">5_000</span><span class="p">,</span><span class="w">
  </span><span class="ss">health_failure_threshold</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
  </span><span class="ss">health_probe_type</span><span class="p">:</span><span class="w"> </span><span class="ss">:deep</span></code></pre><h3 id="consistency-checking" class="section-heading"><a href="#consistency-checking" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Consistency Checking</span></h3><p>Periodic consistency verification for cluster mode.</p><table><thead><tr><th style="text-align: left;">Option</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Description</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">consistency_check_interval</code></td><td style="text-align: left;">integer</td><td style="text-align: left;">60000</td><td style="text-align: left;">Check interval in milliseconds</td></tr></tbody></table><h4>Erlang Example</h4><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="0571634784-1">{</span><span class="ss">consistency_check_interval</span><span class="p">,</span><span class="w"> </span><span class="mi">30000</span><span class="p" data-group-id="0571634784-1">}</span><span class="w">  </span><span class="c1">%% 30 seconds</span></code></pre><h4>Elixir Example</h4><pre><code class="makeup elixir" translate="no"><span class="n">config</span><span class="w"> </span><span class="ss">:reckon_db</span><span class="p">,</span><span class="w">
  </span><span class="ss">consistency_check_interval</span><span class="p">:</span><span class="w"> </span><span class="mi">30_000</span></code></pre><h3 id="persistence" class="section-heading"><a href="#persistence" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Persistence</span></h3><p>Controls periodic snapshot persistence to disk.</p><table><thead><tr><th style="text-align: left;">Option</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Description</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">persistence_interval</code></td><td style="text-align: left;">integer</td><td style="text-align: left;">60000</td><td style="text-align: left;">Persistence interval in milliseconds</td></tr></tbody></table><h4>Erlang Example</h4><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="1785700056-1">{</span><span class="ss">persistence_interval</span><span class="p">,</span><span class="w"> </span><span class="mi">30000</span><span class="p" data-group-id="1785700056-1">}</span><span class="w">  </span><span class="c1">%% 30 seconds</span></code></pre><h4>Elixir Example</h4><pre><code class="makeup elixir" translate="no"><span class="n">config</span><span class="w"> </span><span class="ss">:reckon_db</span><span class="p">,</span><span class="w">
  </span><span class="ss">persistence_interval</span><span class="p">:</span><span class="w"> </span><span class="mi">30_000</span></code></pre><h3 id="telemetry" class="section-heading"><a href="#telemetry" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Telemetry</span></h3><p>Configure telemetry handlers for metrics and logging.</p><table><thead><tr><th style="text-align: left;">Option</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Description</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">telemetry_handlers</code></td><td style="text-align: left;">list</td><td style="text-align: left;"><code class="inline">[logger]</code></td><td style="text-align: left;">List of telemetry handlers</td></tr></tbody></table><p><strong>Available Handlers:</strong></p><ul><li><code class="inline">logger</code> - Logs events via OTP logger</li></ul><h4>Erlang Example</h4><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="9203137699-1">{</span><span class="ss">telemetry_handlers</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9203137699-2">[</span><span class="ss">logger</span><span class="p" data-group-id="9203137699-2">]</span><span class="p" data-group-id="9203137699-1">}</span></code></pre><h4>Elixir Example</h4><pre><code class="makeup elixir" translate="no"><span class="n">config</span><span class="w"> </span><span class="ss">:reckon_db</span><span class="p">,</span><span class="w">
  </span><span class="ss">telemetry_handlers</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="1764774802-1">[</span><span class="ss">:logger</span><span class="p" data-group-id="1764774802-1">]</span></code></pre><h2 id="complete-configuration-examples" class="section-heading"><a href="#complete-configuration-examples" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Complete Configuration Examples</span></h2><h3 id="single-node-development" class="section-heading"><a href="#single-node-development" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Single Node Development</span></h3><pre><code class="makeup erlang" translate="no"><span class="c1">%% Erlang sys.config</span><span class="w">
</span><span class="p" data-group-id="7104608509-1">[</span><span class="w">
  </span><span class="p" data-group-id="7104608509-2">{</span><span class="ss">reckon_db</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7104608509-3">[</span><span class="w">
    </span><span class="p" data-group-id="7104608509-4">{</span><span class="ss">stores</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7104608509-5">[</span><span class="w">
      </span><span class="p" data-group-id="7104608509-6">{</span><span class="ss">dev_store</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7104608509-7">[</span><span class="w">
        </span><span class="p" data-group-id="7104608509-8">{</span><span class="ss">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/tmp/reckon_db/dev&quot;</span><span class="p" data-group-id="7104608509-8">}</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="7104608509-9">{</span><span class="ss">mode</span><span class="p">,</span><span class="w"> </span><span class="ss">single</span><span class="p" data-group-id="7104608509-9">}</span><span class="w">
      </span><span class="p" data-group-id="7104608509-7">]</span><span class="p" data-group-id="7104608509-6">}</span><span class="w">
    </span><span class="p" data-group-id="7104608509-5">]</span><span class="p" data-group-id="7104608509-4">}</span><span class="p">,</span><span class="w">
    </span><span class="c1">%% Small pools for development</span><span class="w">
    </span><span class="p" data-group-id="7104608509-10">{</span><span class="ss">writer_pool_size</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="7104608509-10">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="7104608509-11">{</span><span class="ss">reader_pool_size</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p" data-group-id="7104608509-11">}</span><span class="p">,</span><span class="w">
    </span><span class="c1">%% Fast feedback on issues</span><span class="w">
    </span><span class="p" data-group-id="7104608509-12">{</span><span class="ss">health_probe_interval</span><span class="p">,</span><span class="w"> </span><span class="mi">2000</span><span class="p" data-group-id="7104608509-12">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="7104608509-13">{</span><span class="ss">health_failure_threshold</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="7104608509-13">}</span><span class="p">,</span><span class="w">
    </span><span class="c1">%% Frequent persistence for testing</span><span class="w">
    </span><span class="p" data-group-id="7104608509-14">{</span><span class="ss">persistence_interval</span><span class="p">,</span><span class="w"> </span><span class="mi">5000</span><span class="p" data-group-id="7104608509-14">}</span><span class="w">
  </span><span class="p" data-group-id="7104608509-3">]</span><span class="p" data-group-id="7104608509-2">}</span><span class="w">
</span><span class="p" data-group-id="7104608509-1">]</span><span class="p">.</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="c1"># Elixir config/dev.exs</span><span class="w">
</span><span class="n">config</span><span class="w"> </span><span class="ss">:reckon_db</span><span class="p">,</span><span class="w">
  </span><span class="ss">stores</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="8371715237-1">[</span><span class="w">
    </span><span class="ss">dev_store</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="8371715237-2">[</span><span class="w">
      </span><span class="ss">data_dir</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/tmp/reckon_db/dev&quot;</span><span class="p">,</span><span class="w">
      </span><span class="ss">mode</span><span class="p">:</span><span class="w"> </span><span class="ss">:single</span><span class="w">
    </span><span class="p" data-group-id="8371715237-2">]</span><span class="w">
  </span><span class="p" data-group-id="8371715237-1">]</span><span class="p">,</span><span class="w">
  </span><span class="ss">writer_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
  </span><span class="ss">reader_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
  </span><span class="ss">health_probe_interval</span><span class="p">:</span><span class="w"> </span><span class="mi">2_000</span><span class="p">,</span><span class="w">
  </span><span class="ss">health_failure_threshold</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="ss">persistence_interval</span><span class="p">:</span><span class="w"> </span><span class="mi">5_000</span></code></pre><h3 id="production-cluster" class="section-heading"><a href="#production-cluster" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Production Cluster</span></h3><pre><code class="makeup erlang" translate="no"><span class="c1">%% Erlang sys.config</span><span class="w">
</span><span class="p" data-group-id="2889886754-1">[</span><span class="w">
  </span><span class="p" data-group-id="2889886754-2">{</span><span class="ss">reckon_db</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2889886754-3">[</span><span class="w">
    </span><span class="p" data-group-id="2889886754-4">{</span><span class="ss">stores</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2889886754-5">[</span><span class="w">
      </span><span class="p" data-group-id="2889886754-6">{</span><span class="ss">main_store</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2889886754-7">[</span><span class="w">
        </span><span class="p" data-group-id="2889886754-8">{</span><span class="ss">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/bulk0/reckon_db/main&quot;</span><span class="p" data-group-id="2889886754-8">}</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="2889886754-9">{</span><span class="ss">mode</span><span class="p">,</span><span class="w"> </span><span class="ss">cluster</span><span class="p" data-group-id="2889886754-9">}</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="2889886754-10">{</span><span class="ss">timeout</span><span class="p">,</span><span class="w"> </span><span class="mi">10000</span><span class="p" data-group-id="2889886754-10">}</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="2889886754-11">{</span><span class="ss">writer_pool_size</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p" data-group-id="2889886754-11">}</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="2889886754-12">{</span><span class="ss">reader_pool_size</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p" data-group-id="2889886754-12">}</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="2889886754-13">{</span><span class="ss">gateway_pool_size</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p" data-group-id="2889886754-13">}</span><span class="w">
      </span><span class="p" data-group-id="2889886754-7">]</span><span class="p" data-group-id="2889886754-6">}</span><span class="w">
    </span><span class="p" data-group-id="2889886754-5">]</span><span class="p" data-group-id="2889886754-4">}</span><span class="p">,</span><span class="w">
    </span><span class="c1">%% Production health monitoring</span><span class="w">
    </span><span class="p" data-group-id="2889886754-14">{</span><span class="ss">health_probe_interval</span><span class="p">,</span><span class="w"> </span><span class="mi">5000</span><span class="p" data-group-id="2889886754-14">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="2889886754-15">{</span><span class="ss">health_probe_timeout</span><span class="p">,</span><span class="w"> </span><span class="mi">3000</span><span class="p" data-group-id="2889886754-15">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="2889886754-16">{</span><span class="ss">health_failure_threshold</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p" data-group-id="2889886754-16">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="2889886754-17">{</span><span class="ss">health_probe_type</span><span class="p">,</span><span class="w"> </span><span class="ss">deep</span><span class="p" data-group-id="2889886754-17">}</span><span class="p">,</span><span class="w">
    </span><span class="c1">%% Consistency and persistence</span><span class="w">
    </span><span class="p" data-group-id="2889886754-18">{</span><span class="ss">consistency_check_interval</span><span class="p">,</span><span class="w"> </span><span class="mi">60000</span><span class="p" data-group-id="2889886754-18">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="2889886754-19">{</span><span class="ss">persistence_interval</span><span class="p">,</span><span class="w"> </span><span class="mi">30000</span><span class="p" data-group-id="2889886754-19">}</span><span class="p">,</span><span class="w">
    </span><span class="c1">%% Longer idle timeouts</span><span class="w">
    </span><span class="p" data-group-id="2889886754-20">{</span><span class="ss">reader_idle_timeout_ms</span><span class="p">,</span><span class="w"> </span><span class="mi">300000</span><span class="p" data-group-id="2889886754-20">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="2889886754-21">{</span><span class="ss">writer_idle_timeout_ms</span><span class="p">,</span><span class="w"> </span><span class="mi">300000</span><span class="p" data-group-id="2889886754-21">}</span><span class="w">
  </span><span class="p" data-group-id="2889886754-3">]</span><span class="p" data-group-id="2889886754-2">}</span><span class="w">
</span><span class="p" data-group-id="2889886754-1">]</span><span class="p">.</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="c1"># Elixir config/runtime.exs</span><span class="w">
</span><span class="n">config</span><span class="w"> </span><span class="ss">:reckon_db</span><span class="p">,</span><span class="w">
  </span><span class="ss">stores</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="6181951302-1">[</span><span class="w">
    </span><span class="ss">main_store</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="6181951302-2">[</span><span class="w">
      </span><span class="ss">data_dir</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/bulk0/reckon_db/main&quot;</span><span class="p">,</span><span class="w">
      </span><span class="ss">mode</span><span class="p">:</span><span class="w"> </span><span class="ss">:cluster</span><span class="p">,</span><span class="w">
      </span><span class="ss">timeout</span><span class="p">:</span><span class="w"> </span><span class="mi">10_000</span><span class="p">,</span><span class="w">
      </span><span class="ss">writer_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w">
      </span><span class="ss">reader_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
      </span><span class="ss">gateway_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">
    </span><span class="p" data-group-id="6181951302-2">]</span><span class="w">
  </span><span class="p" data-group-id="6181951302-1">]</span><span class="p">,</span><span class="w">
  </span><span class="c1"># Production health monitoring</span><span class="w">
  </span><span class="ss">health_probe_interval</span><span class="p">:</span><span class="w"> </span><span class="mi">5_000</span><span class="p">,</span><span class="w">
  </span><span class="ss">health_probe_timeout</span><span class="p">:</span><span class="w"> </span><span class="mi">3_000</span><span class="p">,</span><span class="w">
  </span><span class="ss">health_failure_threshold</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="ss">health_probe_type</span><span class="p">:</span><span class="w"> </span><span class="ss">:deep</span><span class="p">,</span><span class="w">
  </span><span class="c1"># Consistency and persistence</span><span class="w">
  </span><span class="ss">consistency_check_interval</span><span class="p">:</span><span class="w"> </span><span class="mi">60_000</span><span class="p">,</span><span class="w">
  </span><span class="ss">persistence_interval</span><span class="p">:</span><span class="w"> </span><span class="mi">30_000</span><span class="p">,</span><span class="w">
  </span><span class="c1"># Longer idle timeouts</span><span class="w">
  </span><span class="ss">reader_idle_timeout_ms</span><span class="p">:</span><span class="w"> </span><span class="mi">300_000</span><span class="p">,</span><span class="w">
  </span><span class="ss">writer_idle_timeout_ms</span><span class="p">:</span><span class="w"> </span><span class="mi">300_000</span></code></pre><h3 id="multi-store-setup" class="section-heading"><a href="#multi-store-setup" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Multi-Store Setup</span></h3><pre><code class="makeup elixir" translate="no"><span class="c1"># Elixir config.exs - Multiple stores for different domains</span><span class="w">
</span><span class="n">config</span><span class="w"> </span><span class="ss">:reckon_db</span><span class="p">,</span><span class="w">
  </span><span class="ss">stores</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="5699052554-1">[</span><span class="w">
    </span><span class="c1"># High-write orders store</span><span class="w">
    </span><span class="ss">orders_store</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="5699052554-2">[</span><span class="w">
      </span><span class="ss">data_dir</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/bulk0/reckon_db/orders&quot;</span><span class="p">,</span><span class="w">
      </span><span class="ss">mode</span><span class="p">:</span><span class="w"> </span><span class="ss">:cluster</span><span class="p">,</span><span class="w">
      </span><span class="ss">writer_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
      </span><span class="ss">reader_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="w">
    </span><span class="p" data-group-id="5699052554-2">]</span><span class="p">,</span><span class="w">
    </span><span class="c1"># Read-heavy analytics store</span><span class="w">
    </span><span class="ss">analytics_store</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="5699052554-3">[</span><span class="w">
      </span><span class="ss">data_dir</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/bulk1/reckon_db/analytics&quot;</span><span class="p">,</span><span class="w">
      </span><span class="ss">mode</span><span class="p">:</span><span class="w"> </span><span class="ss">:single</span><span class="p">,</span><span class="w">
      </span><span class="ss">writer_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
      </span><span class="ss">reader_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
    </span><span class="p" data-group-id="5699052554-3">]</span><span class="p">,</span><span class="w">
    </span><span class="c1"># Low-volume user store</span><span class="w">
    </span><span class="ss">users_store</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="5699052554-4">[</span><span class="w">
      </span><span class="ss">data_dir</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/bulk0/reckon_db/users&quot;</span><span class="p">,</span><span class="w">
      </span><span class="ss">mode</span><span class="p">:</span><span class="w"> </span><span class="ss">:single</span><span class="p">,</span><span class="w">
      </span><span class="ss">writer_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
      </span><span class="ss">reader_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="w">
    </span><span class="p" data-group-id="5699052554-4">]</span><span class="w">
  </span><span class="p" data-group-id="5699052554-1">]</span></code></pre><h2 id="cluster-mode-configuration" class="section-heading"><a href="#cluster-mode-configuration" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Cluster Mode Configuration</span></h2><p>When running in cluster mode, additional Erlang VM configuration is needed.</p><h3 id="vm-args" class="section-heading"><a href="#vm-args" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">vm.args</span></h3><pre><code class="makeup erlang" translate="no"><span class="p">#</span><span class="p">#</span><span class="w"> </span><span class="n">Node</span><span class="w"> </span><span class="nf">name</span><span class="w"> </span><span class="p" data-group-id="9112762553-1">(</span><span class="ss">required</span><span class="w"> </span><span class="ss">for</span><span class="w"> </span><span class="ss">clustering</span><span class="p" data-group-id="9112762553-1">)</span><span class="w">
</span><span class="p">-</span><span class="na">name</span><span class="w"> </span><span class="ss">store1@192</span><span class="p">.</span><span class="mf">168.1</span><span class="p">.</span><span class="mi">10</span><span class="w">

</span><span class="p">#</span><span class="p">#</span><span class="w"> </span><span class="n">Cookie</span><span class="w"> </span><span class="ss">for</span><span class="w"> </span><span class="ss">cluster</span><span class="w"> </span><span class="ss">authentication</span><span class="w">
</span><span class="p">-</span><span class="na">setcookie</span><span class="w"> </span><span class="ss">my_cluster_cookie</span><span class="w">

</span><span class="p">#</span><span class="p">#</span><span class="w"> </span><span class="n">Enable</span><span class="w"> </span><span class="ss">distribution</span><span class="w">
</span><span class="p">-</span><span class="na">proto_dist</span><span class="w"> </span><span class="ss">inet_tcp</span><span class="w">

</span><span class="p">#</span><span class="p">#</span><span class="w"> </span><span class="n">Increase</span><span class="w"> </span><span class="ss">distribution</span><span class="w"> </span><span class="ss">buffer</span><span class="w">
</span><span class="o">+</span><span class="ss">zdbbl</span><span class="w"> </span><span class="mi">32768</span></code></pre><h3 id="connecting-nodes" class="section-heading"><a href="#connecting-nodes" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Connecting Nodes</span></h3><p>Cluster formation happens via Khepri/Ra. Use the API to join nodes:</p><pre><code class="makeup erlang" translate="no"><span class="c1">%% On the joining node</span><span class="w">
</span><span class="nc">reckon_db</span><span class="p">:</span><span class="nf">join_cluster</span><span class="p" data-group-id="8845113505-1">(</span><span class="ss">my_store</span><span class="p">,</span><span class="w"> </span><span class="ss">&#39;store1@192.168.1.10&#39;</span><span class="p" data-group-id="8845113505-1">)</span><span class="p">.</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="c1"># Elixir</span><span class="w">
</span><span class="nc">:reckon_db</span><span class="o">.</span><span class="n">join_cluster</span><span class="p" data-group-id="6977144541-1">(</span><span class="ss">:my_store</span><span class="p">,</span><span class="w"> </span><span class="ss">:&quot;store1@192.168.1.10&quot;</span><span class="p" data-group-id="6977144541-1">)</span></code></pre><h2 id="data-directory-guidelines" class="section-heading"><a href="#data-directory-guidelines" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Data Directory Guidelines</span></h2><h3 id="linux-production" class="section-heading"><a href="#linux-production" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Linux/Production</span></h3><p>Store data on separate disk partitions for performance:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="6688764666-1">{</span><span class="ss">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/bulk0/reckon_db/my_store&quot;</span><span class="p" data-group-id="6688764666-1">}</span></code></pre><h3 id="development" class="section-heading"><a href="#development" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Development</span></h3><p>Use temp directory for ephemeral data:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="3252877279-1">{</span><span class="ss">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/tmp/reckon_db/dev_store&quot;</span><span class="p" data-group-id="3252877279-1">}</span></code></pre><h3 id="docker-container" class="section-heading"><a href="#docker-container" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Docker/Container</span></h3><p>Mount a volume for persistence:</p><pre><code class="yaml">volumes:
  - esdb_data:/var/lib/reckon_db</code></pre><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="0004856648-1">{</span><span class="ss">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/var/lib/reckon_db/my_store&quot;</span><span class="p" data-group-id="0004856648-1">}</span></code></pre><h2 id="performance-tuning" class="section-heading"><a href="#performance-tuning" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Performance Tuning</span></h2><h3 id="high-write-workloads" class="section-heading"><a href="#high-write-workloads" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">High-Write Workloads</span></h3><pre><code class="makeup elixir" translate="no"><span class="n">config</span><span class="w"> </span><span class="ss">:reckon_db</span><span class="p">,</span><span class="w">
  </span><span class="ss">stores</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3944074624-1">[</span><span class="w">
    </span><span class="ss">high_write</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3944074624-2">[</span><span class="w">
      </span><span class="ss">writer_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">      </span><span class="c1"># Many concurrent writers</span><span class="w">
      </span><span class="ss">reader_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">       </span><span class="c1"># Fewer readers needed</span><span class="w">
      </span><span class="ss">mode</span><span class="p">:</span><span class="w"> </span><span class="ss">:cluster</span><span class="w">              </span><span class="c1"># Distribute writes</span><span class="w">
    </span><span class="p" data-group-id="3944074624-2">]</span><span class="w">
  </span><span class="p" data-group-id="3944074624-1">]</span><span class="p">,</span><span class="w">
  </span><span class="ss">persistence_interval</span><span class="p">:</span><span class="w"> </span><span class="mi">60_000</span><span class="w">    </span><span class="c1"># Less frequent persistence</span></code></pre><h3 id="high-read-workloads" class="section-heading"><a href="#high-read-workloads" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">High-Read Workloads</span></h3><pre><code class="makeup elixir" translate="no"><span class="n">config</span><span class="w"> </span><span class="ss">:reckon_db</span><span class="p">,</span><span class="w">
  </span><span class="ss">stores</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7740933073-1">[</span><span class="w">
    </span><span class="ss">high_read</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7740933073-2">[</span><span class="w">
      </span><span class="ss">writer_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">       </span><span class="c1"># Fewer writers needed</span><span class="w">
      </span><span class="ss">reader_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">      </span><span class="c1"># Many concurrent readers</span><span class="w">
      </span><span class="ss">mode</span><span class="p">:</span><span class="w"> </span><span class="ss">:cluster</span><span class="w">              </span><span class="c1"># Read from any replica</span><span class="w">
    </span><span class="p" data-group-id="7740933073-2">]</span><span class="w">
  </span><span class="p" data-group-id="7740933073-1">]</span><span class="p">,</span><span class="w">
  </span><span class="ss">reader_idle_timeout_ms</span><span class="p">:</span><span class="w"> </span><span class="mi">600_000</span><span class="w"> </span><span class="c1"># Keep readers alive longer</span></code></pre><h3 id="low-latency-requirements" class="section-heading"><a href="#low-latency-requirements" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Low-Latency Requirements</span></h3><pre><code class="makeup elixir" translate="no"><span class="n">config</span><span class="w"> </span><span class="ss">:reckon_db</span><span class="p">,</span><span class="w">
  </span><span class="ss">stores</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="8655732446-1">[</span><span class="w">
    </span><span class="ss">low_latency</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="8655732446-2">[</span><span class="w">
      </span><span class="ss">timeout</span><span class="p">:</span><span class="w"> </span><span class="mi">2_000</span><span class="p">,</span><span class="w">             </span><span class="c1"># Fast timeouts</span><span class="w">
      </span><span class="ss">gateway_pool_size</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">       </span><span class="c1"># More gateway workers</span><span class="w">
    </span><span class="p" data-group-id="8655732446-2">]</span><span class="w">
  </span><span class="p" data-group-id="8655732446-1">]</span><span class="p">,</span><span class="w">
  </span><span class="ss">health_probe_interval</span><span class="p">:</span><span class="w"> </span><span class="mi">1_000</span><span class="p">,</span><span class="w">   </span><span class="c1"># Fast failure detection</span><span class="w">
  </span><span class="ss">health_failure_threshold</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">     </span><span class="c1"># Immediate failover</span></code></pre><h2 id="telemetry-events" class="section-heading"><a href="#telemetry-events" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Telemetry Events</span></h2><p>reckon-db emits telemetry events for monitoring:</p><table><thead><tr><th style="text-align: left;">Event</th><th style="text-align: left;">Measurements</th><th style="text-align: left;">Metadata</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">[reckon_db, append, start]</code></td><td style="text-align: left;">-</td><td style="text-align: left;">store_id, stream</td></tr><tr><td style="text-align: left;"><code class="inline">[reckon_db, append, stop]</code></td><td style="text-align: left;">duration</td><td style="text-align: left;">store_id, stream, count</td></tr><tr><td style="text-align: left;"><code class="inline">[reckon_db, append, exception]</code></td><td style="text-align: left;">duration</td><td style="text-align: left;">store_id, stream, reason</td></tr><tr><td style="text-align: left;"><code class="inline">[reckon_db, read, start]</code></td><td style="text-align: left;">-</td><td style="text-align: left;">store_id, stream</td></tr><tr><td style="text-align: left;"><code class="inline">[reckon_db, read, stop]</code></td><td style="text-align: left;">duration</td><td style="text-align: left;">store_id, stream, count</td></tr><tr><td style="text-align: left;"><code class="inline">[reckon_db, read, exception]</code></td><td style="text-align: left;">duration</td><td style="text-align: left;">store_id, stream, reason</td></tr><tr><td style="text-align: left;"><code class="inline">[reckon_db, health, probe]</code></td><td style="text-align: left;">latency</td><td style="text-align: left;">store_id, node, status</td></tr><tr><td style="text-align: left;"><code class="inline">[reckon_db, health, change]</code></td><td style="text-align: left;">-</td><td style="text-align: left;">store_id, node, old, new</td></tr></tbody></table><h3 id="attaching-handlers" class="section-heading"><a href="#attaching-handlers" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Attaching Handlers</span></h3><pre><code class="makeup elixir" translate="no"><span class="c1"># Elixir</span><span class="w">
</span><span class="nc">:telemetry</span><span class="o">.</span><span class="n">attach_many</span><span class="p" data-group-id="3860397408-1">(</span><span class="w">
  </span><span class="s">&quot;reckon-db-metrics&quot;</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="3860397408-2">[</span><span class="w">
    </span><span class="p" data-group-id="3860397408-3">[</span><span class="ss">:reckon_db</span><span class="p">,</span><span class="w"> </span><span class="ss">:append</span><span class="p">,</span><span class="w"> </span><span class="ss">:stop</span><span class="p" data-group-id="3860397408-3">]</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="3860397408-4">[</span><span class="ss">:reckon_db</span><span class="p">,</span><span class="w"> </span><span class="ss">:read</span><span class="p">,</span><span class="w"> </span><span class="ss">:stop</span><span class="p" data-group-id="3860397408-4">]</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="3860397408-5">[</span><span class="ss">:reckon_db</span><span class="p">,</span><span class="w"> </span><span class="ss">:health</span><span class="p">,</span><span class="w"> </span><span class="ss">:change</span><span class="p" data-group-id="3860397408-5">]</span><span class="w">
  </span><span class="p" data-group-id="3860397408-2">]</span><span class="p">,</span><span class="w">
  </span><span class="o">&amp;</span><span class="nc">MyApp.Metrics</span><span class="o">.</span><span class="n">handle_event</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="w">
  </span><span class="no">nil</span><span class="w">
</span><span class="p" data-group-id="3860397408-1">)</span></code></pre><pre><code class="makeup erlang" translate="no"><span class="c1">%% Erlang</span><span class="w">
</span><span class="nc">telemetry</span><span class="p">:</span><span class="nf">attach_many</span><span class="p" data-group-id="2732420007-1">(</span><span class="w">
  </span><span class="p" data-group-id="2732420007-2">&lt;&lt;</span><span class="s">&quot;reckon-db-metrics&quot;</span><span class="p" data-group-id="2732420007-2">&gt;&gt;</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="2732420007-3">[</span><span class="w">
    </span><span class="p" data-group-id="2732420007-4">[</span><span class="ss">reckon_db</span><span class="p">,</span><span class="w"> </span><span class="ss">append</span><span class="p">,</span><span class="w"> </span><span class="ss">stop</span><span class="p" data-group-id="2732420007-4">]</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="2732420007-5">[</span><span class="ss">reckon_db</span><span class="p">,</span><span class="w"> </span><span class="ss">read</span><span class="p">,</span><span class="w"> </span><span class="ss">stop</span><span class="p" data-group-id="2732420007-5">]</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="2732420007-6">[</span><span class="ss">reckon_db</span><span class="p">,</span><span class="w"> </span><span class="ss">health</span><span class="p">,</span><span class="w"> </span><span class="ss">change</span><span class="p" data-group-id="2732420007-6">]</span><span class="w">
  </span><span class="p" data-group-id="2732420007-3">]</span><span class="p">,</span><span class="w">
  </span><span class="k">fun</span><span class="w"> </span><span class="nc">my_metrics</span><span class="p">:</span><span class="ss">handle_event</span><span class="p">/</span><span class="mi">4</span><span class="p">,</span><span class="w">
  </span><span class="ss">undefined</span><span class="w">
</span><span class="p" data-group-id="2732420007-1">)</span><span class="p">.</span></code></pre><h2 id="see-also" class="section-heading"><a href="#see-also" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">See Also</span></h2><ul><li><a href="storage_internals.html">Storage Internals</a> - How data is stored</li><li><a href="cluster_consistency.html">Cluster Consistency</a> - Consistency guarantees</li><li><a href="memory_pressure.html">Memory Pressure</a> - Memory management</li><li><a href="snapshots.html">Snapshots</a> - Snapshot configuration</li></ul>

</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="schema_evolution.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          â† Previous Page
        </span>
        <span class="title">
Schema Evolution
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="memory_pressure.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page â†’
        </span>
        <span class="title">
Memory Pressure
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

          <span class="line">
            <a href="https://hex.pm/packages/reckon_db/1.0.0" class="footer-hex-package">Hex Package</a>

            <a href="https://preview.hex.pm/preview/reckon_db/1.0.0">Hex Preview</a>

              (<a href="https://preview.hex.pm/preview/reckon_db/1.0.0/show/guides/configuration.md">current file</a>)

          </span>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="reckon_db.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.38.2) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>

    </footer>
  </div>
</main>
</div>

  </body>
</html>
