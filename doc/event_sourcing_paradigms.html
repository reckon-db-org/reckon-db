<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.38.2">
    <meta name="project" content="reckon_db v1.1.0">


    <title>Event Sourcing Paradigms — reckon_db v1.1.0</title>

    <link rel="stylesheet" href="dist/html-erlang-DQDXQC7W.css" />

    <script defer src="dist/sidebar_items-B1D808EB.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-DPJLHKSM.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

      <div>
        <a href="readme.html" class="sidebar-projectName" translate="no">
reckon_db
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v1.1.0
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras=""></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of reckon_db</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>Event Sourcing Paradigms: Entity, Relationship, and Process-Centric</h1>


      <a href="https://github.com/reckon-db-org/reckon-db/blob/v1.1.0/guides/event_sourcing_paradigms.md#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>


<p>This guide explores three distinct approaches to event sourcing, each with different mental models, trade-offs, and use cases. Understanding these paradigms helps you choose the right approach for your domain.</p><p><img src="../assets/event_sourcing_paradigms.svg" alt="Three Paradigms Overview"/></p><h2 id="the-three-paradigms" class="section-heading"><a href="#the-three-paradigms" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">The Three Paradigms</span></h2><table><thead><tr><th style="text-align: left;">Aspect</th><th style="text-align: left;">Entity-Centric</th><th style="text-align: left;">Relationship-Centric (DCB)</th><th style="text-align: left;">Process-Centric</th></tr></thead><tbody><tr><td style="text-align: left;"><strong>Stream identity</strong></td><td style="text-align: left;">Entity ID</td><td style="text-align: left;">Context name</td><td style="text-align: left;">Process instance ID</td></tr><tr><td style="text-align: left;"><strong>What stream represents</strong></td><td style="text-align: left;">Entity's complete history</td><td style="text-align: left;">All facts in a bounded context</td><td style="text-align: left;">Business process execution log</td></tr><tr><td style="text-align: left;"><strong>Aggregate purpose</strong></td><td style="text-align: left;">Entity state reconstruction</td><td style="text-align: left;">Ad-hoc decision model (query-time)</td><td style="text-align: left;">Process context (&quot;dossier&quot;)</td></tr><tr><td style="text-align: left;"><strong>Concurrency unit</strong></td><td style="text-align: left;">Single entity's stream</td><td style="text-align: left;">Query-based tag intersection</td><td style="text-align: left;">Single process instance</td></tr><tr><td style="text-align: left;"><strong>Cross-cutting concerns</strong></td><td style="text-align: left;">Sagas, process managers</td><td style="text-align: left;">Tags + query-based locking</td><td style="text-align: left;">Process flow owns all participants</td></tr><tr><td style="text-align: left;"><strong>Mental model</strong></td><td style="text-align: left;">&quot;Entity has history&quot;</td><td style="text-align: left;">&quot;Facts are tagged for slicing&quot;</td><td style="text-align: left;">&quot;Dossier passed desk to desk&quot;</td></tr></tbody></table><hr class="thin"/><h2 id="entity-centric-paradigm-traditional-ddd" class="section-heading"><a href="#entity-centric-paradigm-traditional-ddd" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Entity-Centric Paradigm (Traditional DDD)</span></h2><p>The most common approach, derived from Domain-Driven Design. Each entity (aggregate) owns a dedicated event stream.</p><h3 id="mental-model" class="section-heading"><a href="#mental-model" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Mental Model</span></h3><blockquote><p>&quot;Every entity has a history. The entity IS its history.&quot;</p></blockquote><pre><code class="makeup erlang" translate="no"><span class="n">Stream</span><span class="p">:</span><span class="w"> </span><span class="ss">order</span><span class="o">-</span><span class="mi">123</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="n">OrderPlaced</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="n">ItemAdded</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="n">PaymentReceived</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="n">OrderShipped</span><span class="w">
</span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="n">OrderDelivered</span><span class="w">

</span><span class="n">Stream</span><span class="p">:</span><span class="w"> </span><span class="ss">user</span><span class="o">-</span><span class="mi">456</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="n">UserRegistered</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="n">ProfileUpdated</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="n">PasswordChanged</span><span class="w">
</span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="n">AccountVerified</span></code></pre><h3 id="characteristics" class="section-heading"><a href="#characteristics" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Characteristics</span></h3><p><strong>Strengths:</strong></p><ul><li>Intuitive mapping to domain objects</li><li>Clear ownership: one stream per aggregate</li><li>Well-understood patterns (DDD literature)</li><li>Simple optimistic concurrency (stream version)</li></ul><p><strong>Weaknesses:</strong></p><ul><li>Cross-entity invariants require sagas</li><li>Fact duplication when entities interact</li><li>Saga complexity grows with domain complexity</li><li>Compensating transactions for failure handling</li></ul><h3 id="example-course-enrollment-entity-centric" class="section-heading"><a href="#example-course-enrollment-entity-centric" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Example: Course Enrollment (Entity-Centric)</span></h3><pre><code class="makeup erlang" translate="no"><span class="c1">%% Two streams, fact duplicated</span><span class="w">
</span><span class="c1">%% Stream: course-CS101</span><span class="w">
</span><span class="c1">%%   ├── CourseCreated</span><span class="w">
</span><span class="c1">%%   └── StudentEnrolled {student_id: 456}  ← FACT 1</span><span class="w">
</span><span class="c1">%%</span><span class="w">
</span><span class="c1">%% Stream: student-456</span><span class="w">
</span><span class="c1">%%   ├── StudentCreated</span><span class="w">
</span><span class="c1">%%   └── CourseJoined {course_id: CS101}    ← SAME FACT, DUPLICATED</span><span class="w">

</span><span class="c1">%% Saga required to coordinate:</span><span class="w">
</span><span class="c1">%% 1. Check student course count &lt; 10</span><span class="w">
</span><span class="c1">%% 2. Check course student count &lt; 30</span><span class="w">
</span><span class="c1">%% 3. Append to course stream</span><span class="w">
</span><span class="c1">%% 4. Append to student stream</span><span class="w">
</span><span class="c1">%% 5. If step 4 fails, compensate step 3</span></code></pre><h3 id="when-to-use" class="section-heading"><a href="#when-to-use" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">When to Use</span></h3><ul><li>Domains where entities are truly independent</li><li>Simple CRUD-like operations</li><li>Well-bounded aggregates with few cross-entity invariants</li></ul><hr class="thin"/><h2 id="relationship-centric-paradigm-dynamic-consistency-boundaries" class="section-heading"><a href="#relationship-centric-paradigm-dynamic-consistency-boundaries" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Relationship-Centric Paradigm (Dynamic Consistency Boundaries)</span></h2><p>Introduced by Sara Pellegrini in her &quot;Killing the Aggregate&quot; thesis. Events are tagged with multiple entities, enabling multi-dimensional querying.</p><h3 id="mental-model-1" class="section-heading"><a href="#mental-model-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Mental Model</span></h3><blockquote><p>&quot;Events are facts about relationships, not entities. Facts can be sliced by any participating entity.&quot;</p></blockquote><pre><code class="makeup erlang" translate="no"><span class="n">Stream</span><span class="p">:</span><span class="w"> </span><span class="ss">enrollment</span><span class="o">-</span><span class="nf">context</span><span class="w"> </span><span class="p" data-group-id="3021229588-1">(</span><span class="ss">single</span><span class="w"> </span><span class="ss">stream</span><span class="w"> </span><span class="ss">for</span><span class="w"> </span><span class="ss">all</span><span class="w"> </span><span class="ss">enrollments</span><span class="p" data-group-id="3021229588-1">)</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="n">Enrolled</span><span class="w"> </span><span class="p" data-group-id="3021229588-2">{</span><span class="nc">student</span><span class="p">:</span><span class="w"> </span><span class="mi">456</span><span class="p">,</span><span class="w"> </span><span class="nc">course</span><span class="p">:</span><span class="w"> </span><span class="n">CS101</span><span class="p">,</span><span class="w"> </span><span class="nc">tags</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3021229588-3">[</span><span class="nc">student</span><span class="p">:</span><span class="mi">456</span><span class="p">,</span><span class="w"> </span><span class="nc">course</span><span class="p">:</span><span class="n">CS101</span><span class="p" data-group-id="3021229588-3">]</span><span class="p" data-group-id="3021229588-2">}</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="n">Enrolled</span><span class="w"> </span><span class="p" data-group-id="3021229588-4">{</span><span class="nc">student</span><span class="p">:</span><span class="w"> </span><span class="mi">456</span><span class="p">,</span><span class="w"> </span><span class="nc">course</span><span class="p">:</span><span class="w"> </span><span class="n">MATH201</span><span class="p">,</span><span class="w"> </span><span class="nc">tags</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3021229588-5">[</span><span class="nc">student</span><span class="p">:</span><span class="mi">456</span><span class="p">,</span><span class="w"> </span><span class="nc">course</span><span class="p">:</span><span class="n">MATH201</span><span class="p" data-group-id="3021229588-5">]</span><span class="p" data-group-id="3021229588-4">}</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="n">Enrolled</span><span class="w"> </span><span class="p" data-group-id="3021229588-6">{</span><span class="nc">student</span><span class="p">:</span><span class="w"> </span><span class="mi">789</span><span class="p">,</span><span class="w"> </span><span class="nc">course</span><span class="p">:</span><span class="w"> </span><span class="n">CS101</span><span class="p">,</span><span class="w"> </span><span class="nc">tags</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3021229588-7">[</span><span class="nc">student</span><span class="p">:</span><span class="mi">789</span><span class="p">,</span><span class="w"> </span><span class="nc">course</span><span class="p">:</span><span class="n">CS101</span><span class="p" data-group-id="3021229588-7">]</span><span class="p" data-group-id="3021229588-6">}</span><span class="w">
</span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="w"> </span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="w">

</span><span class="n">Query</span><span class="w"> </span><span class="ss">by</span><span class="w"> </span><span class="nc">tags</span><span class="p">:</span><span class="w">
</span><span class="o">-</span><span class="w"> </span><span class="s">&quot;course:CS101&quot;</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="ss">enrollments</span><span class="w">
</span><span class="o">-</span><span class="w"> </span><span class="s">&quot;student:456&quot;</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="ss">enrollments</span></code></pre><h3 id="characteristics-1" class="section-heading"><a href="#characteristics-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Characteristics</span></h3><p><strong>Strengths:</strong></p><ul><li>No fact duplication</li><li>No sagas for cross-entity invariants</li><li>Query-time flexibility</li><li>Single source of truth for relationships</li></ul><p><strong>Weaknesses:</strong></p><ul><li>Requires tag indexing infrastructure</li><li>Double-query cost (decision + precondition check)</li><li>Query-time aggregation loses temporal context</li><li>Mental model shift from traditional DDD</li></ul><h3 id="example-course-enrollment-dcb" class="section-heading"><a href="#example-course-enrollment-dcb" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Example: Course Enrollment (DCB)</span></h3><pre><code class="makeup erlang" translate="no"><span class="c1">%% Single stream with tags</span><span class="w">
</span><span class="n">Event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="1572463329-1">#{</span><span class="w">
    </span><span class="ss">event_type</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ss">enrollment_requested</span><span class="p">,</span><span class="w">
    </span><span class="ss">data</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="1572463329-2">#{</span><span class="ss">student_id</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mi">456</span><span class="p">,</span><span class="w"> </span><span class="ss">course_id</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="1572463329-3">&lt;&lt;</span><span class="s">&quot;CS101&quot;</span><span class="p" data-group-id="1572463329-3">&gt;&gt;</span><span class="p" data-group-id="1572463329-2">}</span><span class="p">,</span><span class="w">
    </span><span class="ss">tags</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="1572463329-4">[</span><span class="p" data-group-id="1572463329-5">&lt;&lt;</span><span class="s">&quot;student:456&quot;</span><span class="p" data-group-id="1572463329-5">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1572463329-6">&lt;&lt;</span><span class="s">&quot;course:CS101&quot;</span><span class="p" data-group-id="1572463329-6">&gt;&gt;</span><span class="p" data-group-id="1572463329-4">]</span><span class="w">
</span><span class="p" data-group-id="1572463329-1">}</span><span class="p">,</span><span class="w">

</span><span class="c1">%% Query-based concurrency check:</span><span class="w">
</span><span class="c1">%% 1. Query events matching &quot;course:CS101&quot; → get count + last position</span><span class="w">
</span><span class="c1">%% 2. Query events matching &quot;student:456&quot; → get count + last position</span><span class="w">
</span><span class="c1">%% 3. Append with precondition: no new events matching either query since position</span><span class="w">
</span><span class="n">Query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="1572463329-7">{</span><span class="ow">and</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1572463329-8">[</span><span class="p" data-group-id="1572463329-9">{</span><span class="ss">tags</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1572463329-10">[</span><span class="p" data-group-id="1572463329-11">&lt;&lt;</span><span class="s">&quot;course:CS101&quot;</span><span class="p" data-group-id="1572463329-11">&gt;&gt;</span><span class="p" data-group-id="1572463329-10">]</span><span class="p" data-group-id="1572463329-9">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1572463329-12">{</span><span class="ss">tags</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1572463329-13">[</span><span class="p" data-group-id="1572463329-14">&lt;&lt;</span><span class="s">&quot;student:456&quot;</span><span class="p" data-group-id="1572463329-14">&gt;&gt;</span><span class="p" data-group-id="1572463329-13">]</span><span class="p" data-group-id="1572463329-12">}</span><span class="p" data-group-id="1572463329-8">]</span><span class="p" data-group-id="1572463329-7">}</span><span class="p">,</span><span class="w">
</span><span class="nc">reckon_db</span><span class="p">:</span><span class="nf">append</span><span class="p" data-group-id="1572463329-15">(</span><span class="p" data-group-id="1572463329-16">&lt;&lt;</span><span class="s">&quot;enrollments&quot;</span><span class="p" data-group-id="1572463329-16">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1572463329-17">[</span><span class="n">Event</span><span class="p" data-group-id="1572463329-17">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1572463329-18">{</span><span class="k">query</span><span class="p">,</span><span class="w"> </span><span class="n">Query</span><span class="p">,</span><span class="w"> </span><span class="n">LastPosition</span><span class="p" data-group-id="1572463329-18">}</span><span class="p" data-group-id="1572463329-15">)</span><span class="p">.</span></code></pre><h3 id="when-to-use-1" class="section-heading"><a href="#when-to-use-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">When to Use</span></h3><ul><li>Domains dominated by relationships between entities</li><li>Cross-entity invariants are common</li><li>Analytical/reporting needs require multi-dimensional slicing</li><li>Willing to invest in tag indexing infrastructure</li></ul><h3 id="references" class="section-heading"><a href="#references" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">References</span></h3><ul><li><a href="https://dcb.events/">DCB.events</a> - Official documentation</li><li><a href="https://sara.event-thinking.io/">Sara Pellegrini's Event Thinking</a></li><li><a href="https://www.axoniq.io/blog/dcb-in-af-5">Axon Framework 5 DCB Support</a></li><li><a href="https://docs.eventsourcingdb.io/best-practices/dynamic-consistency-boundaries/">EventSourcingDB DCB Best Practices</a></li></ul><hr class="thin"/><h2 id="process-centric-paradigm-the-dossier-model" class="section-heading"><a href="#process-centric-paradigm-the-dossier-model" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Process-Centric Paradigm (The Dossier Model)</span></h2><p><strong>ReckonDB's recommended approach.</strong> An event stream represents a business process instance, not an entity. The aggregate is the accumulated context - like a dossier passed from desk to desk.</p><h3 id="mental-model-2" class="section-heading"><a href="#mental-model-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Mental Model</span></h3><blockquote><p>&quot;An event stream is an ordered log of facts that represent a business process. The aggregate is the 'dossier' - accumulated context passed from desk to desk, gradually filling with facts.&quot;</p></blockquote><p><img src="../assets/dossier_metaphor.svg" alt="The Dossier Metaphor"/></p><h3 id="the-dossier-metaphor" class="section-heading"><a href="#the-dossier-metaphor" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">The Dossier Metaphor</span></h3><p>Imagine a loan application process in a traditional office:</p><pre><code class="makeup erlang" translate="no"><span class="err">┌</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┐</span><span class="w">
</span><span class="err">│</span><span class="w"> </span><span class="n">THE</span><span class="w"> </span><span class="n">DOSSIER</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Physical</span><span class="w"> </span><span class="ss">folder</span><span class="w"> </span><span class="ss">passed</span><span class="w"> </span><span class="ss">between</span><span class="w"> </span><span class="ss">desks</span><span class="w">              </span><span class="err">│</span><span class="w">
</span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┤</span><span class="w">
</span><span class="err">│</span><span class="w">                                                                 </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w"> </span><span class="n">DESK</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p" data-group-id="3596133070-1">(</span><span class="n">Intake</span><span class="p" data-group-id="3596133070-1">)</span><span class="p">:</span><span class="w">                                                </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">└</span><span class="err">─</span><span class="w"> </span><span class="n">Application</span><span class="w"> </span><span class="ss">form</span><span class="w"> </span><span class="ss">received</span><span class="w">                                  </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">└</span><span class="err">─</span><span class="w"> </span><span class="n">Dossier</span><span class="w"> </span><span class="nc">starts</span><span class="p">:</span><span class="w"> </span><span class="ss">applicant</span><span class="w"> </span><span class="ss">name</span><span class="p">,</span><span class="w"> </span><span class="ss">requested</span><span class="w"> </span><span class="ss">amount</span><span class="w">           </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">                                                                 </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w"> </span><span class="n">DESK</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p" data-group-id="3596133070-2">(</span><span class="n">Credit</span><span class="w"> </span><span class="n">Check</span><span class="p" data-group-id="3596133070-2">)</span><span class="p">:</span><span class="w">                                          </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">└</span><span class="err">─</span><span class="w"> </span><span class="n">Credit</span><span class="w"> </span><span class="ss">report</span><span class="w"> </span><span class="ss">pulled</span><span class="w">                                       </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">└</span><span class="err">─</span><span class="w"> </span><span class="n">Dossier</span><span class="w"> </span><span class="nc">gains</span><span class="p">:</span><span class="w"> </span><span class="ss">credit</span><span class="w"> </span><span class="ss">score</span><span class="p">,</span><span class="w"> </span><span class="ss">debt</span><span class="o">-</span><span class="ss">to</span><span class="o">-</span><span class="ss">income</span><span class="w"> </span><span class="ss">ratio</span><span class="w">          </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">                                                                 </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w"> </span><span class="n">DESK</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p" data-group-id="3596133070-3">(</span><span class="n">Underwriting</span><span class="p" data-group-id="3596133070-3">)</span><span class="p">:</span><span class="w">                                          </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">└</span><span class="err">─</span><span class="w"> </span><span class="n">Risk</span><span class="w"> </span><span class="ss">assessment</span><span class="w"> </span><span class="ss">completed</span><span class="w">                                  </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">└</span><span class="err">─</span><span class="w"> </span><span class="n">Dossier</span><span class="w"> </span><span class="nc">gains</span><span class="p">:</span><span class="w"> </span><span class="ss">approval</span><span class="w"> </span><span class="ss">decision</span><span class="p">,</span><span class="w"> </span><span class="ss">conditions</span><span class="p">,</span><span class="w"> </span><span class="ss">notes</span><span class="w">        </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">                                                                 </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w"> </span><span class="n">DESK</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p" data-group-id="3596133070-4">(</span><span class="n">Documentation</span><span class="p" data-group-id="3596133070-4">)</span><span class="p">:</span><span class="w">                                         </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">└</span><span class="err">─</span><span class="w"> </span><span class="n">Documents</span><span class="w"> </span><span class="ss">verified</span><span class="w">                                         </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">└</span><span class="err">─</span><span class="w"> </span><span class="n">Dossier</span><span class="w"> </span><span class="nc">gains</span><span class="p">:</span><span class="w"> </span><span class="ss">verification</span><span class="w"> </span><span class="ss">checklist</span><span class="p">,</span><span class="w"> </span><span class="ss">issues</span><span class="w"> </span><span class="ss">found</span><span class="w">        </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">                                                                 </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w"> </span><span class="n">DESK</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="p" data-group-id="3596133070-5">(</span><span class="n">Closing</span><span class="p" data-group-id="3596133070-5">)</span><span class="p">:</span><span class="w">                                               </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">└</span><span class="err">─</span><span class="w"> </span><span class="n">Loan</span><span class="w"> </span><span class="ss">disbursed</span><span class="w">                                             </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">   </span><span class="err">└</span><span class="err">─</span><span class="w"> </span><span class="n">Dossier</span><span class="w"> </span><span class="nc">complete</span><span class="p">:</span><span class="w"> </span><span class="ss">final</span><span class="w"> </span><span class="ss">terms</span><span class="p">,</span><span class="w"> </span><span class="ss">disbursement</span><span class="w"> </span><span class="ss">details</span><span class="w">        </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w">                                                                 </span><span class="err">│</span><span class="w">
</span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┘</span><span class="w">

</span><span class="n">The</span><span class="w"> </span><span class="n">PROCESS</span><span class="w"> </span><span class="ss">owns</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">stream</span><span class="p">.</span><span class="w">
</span><span class="n">The</span><span class="w"> </span><span class="ss">applicant</span><span class="p">,</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">loan</span><span class="p">,</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">credit</span><span class="w"> </span><span class="ss">bureau</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="ss">all</span><span class="w"> </span><span class="ss">are</span><span class="w"> </span><span class="n">PARTICIPANTS</span><span class="p">.</span></code></pre><h3 id="characteristics-2" class="section-heading"><a href="#characteristics-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Characteristics</span></h3><p><strong>Strengths:</strong></p><ul><li>Complete auditability: dossier records WHAT WE KNEW at each decision</li><li>Single stream per process instance (no coordination)</li><li>Invariants checked as process guards using read models</li><li>Natural fit for workflow-heavy domains</li><li>&quot;Why did we approve this?&quot; → replay the dossier</li></ul><p><strong>Weaknesses:</strong></p><ul><li>Requires read models for cross-process queries</li><li>Less intuitive for pure entity-focused domains</li><li>May need to denormalize entity state across processes</li></ul><h3 id="example-course-enrollment-process-centric" class="section-heading"><a href="#example-course-enrollment-process-centric" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Example: Course Enrollment (Process-Centric)</span></h3><pre><code class="makeup erlang" translate="no"><span class="c1">%% Process: EnrollmentRequest</span><span class="w">
</span><span class="c1">%% Stream: enrollment-request-{uuid}</span><span class="w">
</span><span class="w">
</span><span class="p">-</span><span class="na">record</span><span class="p" data-group-id="3682934273-1">(</span><span class="ss">enrollment_dossier</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3682934273-2">{</span><span class="w">
    </span><span class="ss">request_id</span><span class="p">,</span><span class="w">
    </span><span class="ss">student_id</span><span class="p">,</span><span class="w">
    </span><span class="ss">course_id</span><span class="p">,</span><span class="w">
    </span><span class="c1">%% Context captured at decision time</span><span class="w">
    </span><span class="ss">student_courses_at_request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="3682934273-3">[</span><span class="p" data-group-id="3682934273-3">]</span><span class="p">,</span><span class="w">
    </span><span class="ss">course_students_at_request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="3682934273-4">[</span><span class="p" data-group-id="3682934273-4">]</span><span class="p">,</span><span class="w">
    </span><span class="c1">%% Process outcome</span><span class="w">
    </span><span class="ss">validation_status</span><span class="p">,</span><span class="w">
    </span><span class="ss">outcome</span><span class="p">,</span><span class="w">
    </span><span class="ss">outcome_reason</span><span class="w">
</span><span class="p" data-group-id="3682934273-2">}</span><span class="p" data-group-id="3682934273-1">)</span><span class="p">.</span><span class="w">

</span><span class="c1">%% Command handler: check invariants as process GUARDS</span><span class="w">
</span><span class="nf">handle_command</span><span class="p" data-group-id="3682934273-5">(</span><span class="o">#</span><span class="ss">request_enrollment</span><span class="p" data-group-id="3682934273-6">{</span><span class="ss">student_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="ss">course_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C</span><span class="p" data-group-id="3682934273-6">}</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="n">State</span><span class="p" data-group-id="3682934273-5">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="c1">%% Fetch current state from READ MODELS (projections)</span><span class="w">
    </span><span class="n">StudentCourses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">enrollments_projection</span><span class="p">:</span><span class="nf">courses_for_student</span><span class="p" data-group-id="3682934273-7">(</span><span class="n">S</span><span class="p" data-group-id="3682934273-7">)</span><span class="p">,</span><span class="w">
    </span><span class="n">CourseStudents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">enrollments_projection</span><span class="p">:</span><span class="nf">students_for_course</span><span class="p" data-group-id="3682934273-8">(</span><span class="n">C</span><span class="p" data-group-id="3682934273-8">)</span><span class="p">,</span><span class="w">

    </span><span class="c1">%% Guard: check both invariants BEFORE emitting events</span><span class="w">
    </span><span class="k">case</span><span class="w"> </span><span class="p" data-group-id="3682934273-9">{</span><span class="nf">length</span><span class="p" data-group-id="3682934273-10">(</span><span class="n">StudentCourses</span><span class="p" data-group-id="3682934273-10">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="nf">length</span><span class="p" data-group-id="3682934273-11">(</span><span class="n">CourseStudents</span><span class="p" data-group-id="3682934273-11">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">30</span><span class="p" data-group-id="3682934273-9">}</span><span class="w"> </span><span class="k">of</span><span class="w">
        </span><span class="p" data-group-id="3682934273-12">{</span><span class="ss">true</span><span class="p">,</span><span class="w"> </span><span class="ss">true</span><span class="p" data-group-id="3682934273-12">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="c1">%% Dossier records what we knew at decision time</span><span class="w">
            </span><span class="p" data-group-id="3682934273-13">[</span><span class="o">#</span><span class="ss">enrollment_requested</span><span class="p" data-group-id="3682934273-14">{</span><span class="w">
                </span><span class="ss">student_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">S</span><span class="p">,</span><span class="w">
                </span><span class="ss">course_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w">
                </span><span class="ss">student_courses_at_request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StudentCourses</span><span class="p">,</span><span class="w">
                </span><span class="ss">course_students_at_request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CourseStudents</span><span class="w">
            </span><span class="p" data-group-id="3682934273-14">}</span><span class="p" data-group-id="3682934273-13">]</span><span class="p">;</span><span class="w">
        </span><span class="p" data-group-id="3682934273-15">{</span><span class="ss">false</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p" data-group-id="3682934273-15">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="p" data-group-id="3682934273-16">[</span><span class="o">#</span><span class="ss">enrollment_rejected</span><span class="p" data-group-id="3682934273-17">{</span><span class="w">
                </span><span class="ss">student_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">S</span><span class="p">,</span><span class="w">
                </span><span class="ss">course_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w">
                </span><span class="ss">reason</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">student_course_limit_reached</span><span class="p">,</span><span class="w">
                </span><span class="ss">student_course_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">length</span><span class="p" data-group-id="3682934273-18">(</span><span class="n">StudentCourses</span><span class="p" data-group-id="3682934273-18">)</span><span class="w">
            </span><span class="p" data-group-id="3682934273-17">}</span><span class="p" data-group-id="3682934273-16">]</span><span class="p">;</span><span class="w">
        </span><span class="p" data-group-id="3682934273-19">{</span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="ss">false</span><span class="p" data-group-id="3682934273-19">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="p" data-group-id="3682934273-20">[</span><span class="o">#</span><span class="ss">enrollment_rejected</span><span class="p" data-group-id="3682934273-21">{</span><span class="w">
                </span><span class="ss">student_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">S</span><span class="p">,</span><span class="w">
                </span><span class="ss">course_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w">
                </span><span class="ss">reason</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">course_capacity_reached</span><span class="p">,</span><span class="w">
                </span><span class="ss">course_student_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">length</span><span class="p" data-group-id="3682934273-22">(</span><span class="n">CourseStudents</span><span class="p" data-group-id="3682934273-22">)</span><span class="w">
            </span><span class="p" data-group-id="3682934273-21">}</span><span class="p" data-group-id="3682934273-20">]</span><span class="w">
    </span><span class="k">end</span><span class="p">.</span><span class="w">

</span><span class="c1">%% Apply events to build dossier state</span><span class="w">
</span><span class="nf">apply_event</span><span class="p" data-group-id="3682934273-23">(</span><span class="o">#</span><span class="ss">enrollment_requested</span><span class="p" data-group-id="3682934273-24">{</span><span class="p" data-group-id="3682934273-24">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">E</span><span class="p">,</span><span class="w"> </span><span class="n">Dossier</span><span class="p" data-group-id="3682934273-23">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="n">Dossier</span><span class="o">#</span><span class="ss">enrollment_dossier</span><span class="p" data-group-id="3682934273-25">{</span><span class="w">
        </span><span class="ss">student_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">E</span><span class="o">#</span><span class="ss">enrollment_requested</span><span class="p">.</span><span class="ss">student_id</span><span class="p">,</span><span class="w">
        </span><span class="ss">course_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">E</span><span class="o">#</span><span class="ss">enrollment_requested</span><span class="p">.</span><span class="ss">course_id</span><span class="p">,</span><span class="w">
        </span><span class="ss">student_courses_at_request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">E</span><span class="o">#</span><span class="ss">enrollment_requested</span><span class="p">.</span><span class="ss">student_courses_at_request</span><span class="p">,</span><span class="w">
        </span><span class="ss">course_students_at_request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">E</span><span class="o">#</span><span class="ss">enrollment_requested</span><span class="p">.</span><span class="ss">course_students_at_request</span><span class="p">,</span><span class="w">
        </span><span class="ss">validation_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">valid</span><span class="w">
    </span><span class="p" data-group-id="3682934273-25">}</span><span class="p">;</span><span class="w">

</span><span class="nf">apply_event</span><span class="p" data-group-id="3682934273-26">(</span><span class="o">#</span><span class="ss">enrollment_completed</span><span class="p" data-group-id="3682934273-27">{</span><span class="p" data-group-id="3682934273-27">}</span><span class="p">,</span><span class="w"> </span><span class="n">Dossier</span><span class="p" data-group-id="3682934273-26">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="n">Dossier</span><span class="o">#</span><span class="ss">enrollment_dossier</span><span class="p" data-group-id="3682934273-28">{</span><span class="ss">outcome</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">completed</span><span class="p" data-group-id="3682934273-28">}</span><span class="p">;</span><span class="w">

</span><span class="nf">apply_event</span><span class="p" data-group-id="3682934273-29">(</span><span class="o">#</span><span class="ss">enrollment_rejected</span><span class="p" data-group-id="3682934273-30">{</span><span class="ss">reason</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p" data-group-id="3682934273-30">}</span><span class="p">,</span><span class="w"> </span><span class="n">Dossier</span><span class="p" data-group-id="3682934273-29">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="n">Dossier</span><span class="o">#</span><span class="ss">enrollment_dossier</span><span class="p" data-group-id="3682934273-31">{</span><span class="w">
        </span><span class="ss">outcome</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">rejected</span><span class="p">,</span><span class="w">
        </span><span class="ss">outcome_reason</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="w">
    </span><span class="p" data-group-id="3682934273-31">}</span><span class="p">.</span></code></pre><h3 id="the-key-insight-temporal-context" class="section-heading"><a href="#the-key-insight-temporal-context" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">The Key Insight: Temporal Context</span></h3><p>The process-centric model captures <strong>temporal context</strong> that query-time aggregation cannot:</p><pre><code class="makeup erlang" translate="no"><span class="n">AUDITOR</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Why was this loan approved despite the applicant&#39;s low credit score?&quot;</span><span class="w">

</span><span class="n">ENTITY</span><span class="o">-</span><span class="n">CENTRIC</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;The aggregate says approved. Check the saga logs... somewhere.&quot;</span><span class="w">

</span><span class="n">DCB</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Query the events... but we only know the final state, not what
      the underwriter saw at decision time.&quot;</span><span class="w">

</span><span class="n">PROCESS</span><span class="o">-</span><span class="n">CENTRIC</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Replay the dossier. At decision time (event 3),
                  the underwriter saw: credit score 620, but debt-to-income
                  was 28% (good), and applicant had 5 years at current job.
                  The dossier records all context that was available.&quot;</span></code></pre><h3 id="when-to-use-2" class="section-heading"><a href="#when-to-use-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">When to Use</span></h3><ul><li>Workflow-heavy domains (loan processing, insurance claims, order fulfillment)</li><li>Regulatory/compliance requirements for decision auditability</li><li>Processes with multiple participants that must be coordinated</li><li>Long-running processes with multiple decision points</li></ul><hr class="thin"/><h2 id="paradigm-comparison-the-enrollment-problem" class="section-heading"><a href="#paradigm-comparison-the-enrollment-problem" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Paradigm Comparison: The Enrollment Problem</span></h2><p>All three paradigms can solve the same problem. Here's how they compare:</p><table><thead><tr><th style="text-align: left;">Paradigm</th><th style="text-align: left;">Solution</th><th style="text-align: left;">Code Complexity</th><th style="text-align: left;">Runtime Complexity</th><th style="text-align: left;">Auditability</th></tr></thead><tbody><tr><td style="text-align: left;"><strong>Entity-Centric</strong></td><td style="text-align: left;">Two streams + saga</td><td style="text-align: left;">High (saga logic, compensation)</td><td style="text-align: left;">Medium (saga orchestration)</td><td style="text-align: left;">Medium</td></tr><tr><td style="text-align: left;"><strong>DCB</strong></td><td style="text-align: left;">Tags + query-based locking</td><td style="text-align: left;">Medium (tag indexing)</td><td style="text-align: left;">Higher (double queries)</td><td style="text-align: left;">Low (query-time)</td></tr><tr><td style="text-align: left;"><strong>Process-Centric</strong></td><td style="text-align: left;">Process stream + read model guards</td><td style="text-align: left;">Low (simple guards)</td><td style="text-align: left;">Low (single stream writes)</td><td style="text-align: left;">High (temporal)</td></tr></tbody></table><h3 id="complexity-analysis" class="section-heading"><a href="#complexity-analysis" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Complexity Analysis</span></h3><pre><code class="makeup erlang" translate="no"><span class="n">Entity</span><span class="o">-</span><span class="n">Centric</span><span class="p">:</span><span class="w">
  </span><span class="err">┌</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┐</span><span class="w">
  </span><span class="err">│</span><span class="w"> </span><span class="n">Components</span><span class="w"> </span><span class="nc">needed</span><span class="p">:</span><span class="w">                                          </span><span class="err">│</span><span class="w">
  </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Course</span><span class="w"> </span><span class="ss">aggregate</span><span class="w">                                          </span><span class="err">│</span><span class="w">
  </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Student</span><span class="w"> </span><span class="ss">aggregate</span><span class="w">                                         </span><span class="err">│</span><span class="w">
  </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">EnrollmentSaga</span><span class="w"> </span><span class="p" data-group-id="5335370207-1">(</span><span class="ss">coordinates</span><span class="w"> </span><span class="ss">both</span><span class="p" data-group-id="5335370207-1">)</span><span class="w">                         </span><span class="err">│</span><span class="w">
  </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">CompensationHandler</span><span class="w"> </span><span class="p" data-group-id="5335370207-2">(</span><span class="ss">rollback</span><span class="w"> </span><span class="ss">on</span><span class="w"> </span><span class="ss">failure</span><span class="p" data-group-id="5335370207-2">)</span><span class="w">                 </span><span class="err">│</span><span class="w">
  </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="ss">streams</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="ss">event</span><span class="w"> </span><span class="ss">types</span><span class="p">,</span><span class="w"> </span><span class="ss">saga</span><span class="w"> </span><span class="ss">state</span><span class="w"> </span><span class="ss">machine</span><span class="w">              </span><span class="err">│</span><span class="w">
  </span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┘</span><span class="w">

</span><span class="n">DCB</span><span class="p">:</span><span class="w">
  </span><span class="err">┌</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┐</span><span class="w">
  </span><span class="err">│</span><span class="w"> </span><span class="n">Components</span><span class="w"> </span><span class="nc">needed</span><span class="p">:</span><span class="w">                                          </span><span class="err">│</span><span class="w">
  </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="nf">index</span><span class="w"> </span><span class="p" data-group-id="5335370207-3">(</span><span class="ss">new</span><span class="w"> </span><span class="ss">infrastructure</span><span class="p" data-group-id="5335370207-3">)</span><span class="w">                            </span><span class="err">│</span><span class="w">
  </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Query</span><span class="o">-</span><span class="ss">based</span><span class="w"> </span><span class="nf">concurrency</span><span class="w"> </span><span class="p" data-group-id="5335370207-4">(</span><span class="ss">new</span><span class="w"> </span><span class="ss">append</span><span class="w"> </span><span class="ss">mode</span><span class="p" data-group-id="5335370207-4">)</span><span class="w">                 </span><span class="err">│</span><span class="w">
  </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Decision</span><span class="w"> </span><span class="ss">model</span><span class="w"> </span><span class="ss">builder</span><span class="w">                                    </span><span class="err">│</span><span class="w">
  </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="ss">stream</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="ss">event</span><span class="w"> </span><span class="ss">type</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="ss">queries</span><span class="w"> </span><span class="ss">per</span><span class="w"> </span><span class="ss">write</span><span class="w">               </span><span class="err">│</span><span class="w">
  </span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┘</span><span class="w">

</span><span class="n">Process</span><span class="o">-</span><span class="n">Centric</span><span class="p">:</span><span class="w">
  </span><span class="err">┌</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┐</span><span class="w">
  </span><span class="err">│</span><span class="w"> </span><span class="n">Components</span><span class="w"> </span><span class="nc">needed</span><span class="p">:</span><span class="w">                                          </span><span class="err">│</span><span class="w">
  </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">EnrollmentRequest</span><span class="w"> </span><span class="nf">process</span><span class="w"> </span><span class="p" data-group-id="5335370207-5">(</span><span class="ss">aggregate</span><span class="p" data-group-id="5335370207-5">)</span><span class="w">                     </span><span class="err">│</span><span class="w">
  </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">EnrollmentsProjection</span><span class="w"> </span><span class="p" data-group-id="5335370207-6">(</span><span class="ss">read</span><span class="w"> </span><span class="ss">model</span><span class="p" data-group-id="5335370207-6">)</span><span class="w">                        </span><span class="err">│</span><span class="w">
  </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="ss">stream</span><span class="w"> </span><span class="ss">per</span><span class="w"> </span><span class="ss">request</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">-</span><span class="mi">3</span><span class="w"> </span><span class="ss">event</span><span class="w"> </span><span class="ss">types</span><span class="p">,</span><span class="w"> </span><span class="ss">simple</span><span class="w"> </span><span class="ss">guards</span><span class="w">      </span><span class="err">│</span><span class="w">
  </span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┘</span></code></pre><hr class="thin"/><h2 id="choosing-the-right-paradigm" class="section-heading"><a href="#choosing-the-right-paradigm" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Choosing the Right Paradigm</span></h2><h3 id="decision-framework" class="section-heading"><a href="#decision-framework" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Decision Framework</span></h3><pre><code class="makeup erlang" translate="no"><span class="n">START</span><span class="w">
  </span><span class="err">│</span><span class="w">
  </span><span class="err">▼</span><span class="w">
</span><span class="err">┌</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┐</span><span class="w">
</span><span class="err">│</span><span class="w"> </span><span class="n">Is</span><span class="w"> </span><span class="ss">your</span><span class="w"> </span><span class="ss">domain</span><span class="w"> </span><span class="ss">workflow</span><span class="o">-</span><span class="ss">heavy</span><span class="o">?</span><span class="w">          </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w"> </span><span class="p" data-group-id="8055469588-1">(</span><span class="ss">loan</span><span class="w"> </span><span class="ss">processing</span><span class="p">,</span><span class="w"> </span><span class="ss">claims</span><span class="p">,</span><span class="w"> </span><span class="ss">fulfillment</span><span class="p" data-group-id="8055469588-1">)</span><span class="w">  </span><span class="err">│</span><span class="w">
</span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┘</span><span class="w">
  </span><span class="err">│</span><span class="w">                              </span><span class="err">│</span><span class="w">
  </span><span class="n">YES</span><span class="w">                            </span><span class="n">NO</span><span class="w">
  </span><span class="err">│</span><span class="w">                              </span><span class="err">│</span><span class="w">
  </span><span class="err">▼</span><span class="w">                              </span><span class="err">▼</span><span class="w">
</span><span class="err">┌</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┐</span><span class="w">    </span><span class="err">┌</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┐</span><span class="w">
</span><span class="err">│</span><span class="w"> </span><span class="n">PROCESS</span><span class="o">-</span><span class="n">CENTRIC</span><span class="w"> </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Do</span><span class="w"> </span><span class="ss">you</span><span class="w"> </span><span class="ss">have</span><span class="w"> </span><span class="ss">many</span><span class="w"> </span><span class="ss">cross</span><span class="o">-</span><span class="ss">entity</span><span class="w">   </span><span class="err">│</span><span class="w">
</span><span class="err">│</span><span class="w"> </span><span class="p" data-group-id="8055469588-2">(</span><span class="n">Dossier</span><span class="w"> </span><span class="n">Model</span><span class="p" data-group-id="8055469588-2">)</span><span class="w"> </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="ss">invariants</span><span class="o">?</span><span class="w">                     </span><span class="err">│</span><span class="w">
</span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┘</span><span class="w">    </span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┘</span><span class="w">
                         </span><span class="err">│</span><span class="w">                        </span><span class="err">│</span><span class="w">
                         </span><span class="n">YES</span><span class="w">                      </span><span class="n">NO</span><span class="w">
                         </span><span class="err">│</span><span class="w">                        </span><span class="err">│</span><span class="w">
                         </span><span class="err">▼</span><span class="w">                        </span><span class="err">▼</span><span class="w">
               </span><span class="err">┌</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┐</span><span class="w">   </span><span class="err">┌</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┐</span><span class="w">
               </span><span class="err">│</span><span class="w"> </span><span class="n">Can</span><span class="w"> </span><span class="ss">you</span><span class="w"> </span><span class="ss">invest</span><span class="w"> </span><span class="ss">in</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">ENTITY</span><span class="o">-</span><span class="n">CENTRIC</span><span class="w">  </span><span class="err">│</span><span class="w">
               </span><span class="err">│</span><span class="w"> </span><span class="ss">tag</span><span class="w"> </span><span class="ss">infrastructure</span><span class="o">?</span><span class="w"> </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="p" data-group-id="8055469588-3">(</span><span class="n">Traditional</span><span class="p" data-group-id="8055469588-3">)</span><span class="w">   </span><span class="err">│</span><span class="w">
               </span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┘</span><span class="w">   </span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┘</span><span class="w">
                 </span><span class="err">│</span><span class="w">               </span><span class="err">│</span><span class="w">
                 </span><span class="n">YES</span><span class="w">             </span><span class="n">NO</span><span class="w">
                 </span><span class="err">│</span><span class="w">               </span><span class="err">│</span><span class="w">
                 </span><span class="err">▼</span><span class="w">               </span><span class="err">▼</span><span class="w">
         </span><span class="err">┌</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┐</span><span class="w">   </span><span class="err">┌</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┐</span><span class="w">
         </span><span class="err">│</span><span class="w">    </span><span class="n">DCB</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">PROCESS</span><span class="o">-</span><span class="n">CENTRIC</span><span class="w"> </span><span class="err">│</span><span class="w">
         </span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┘</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="p" data-group-id="8055469588-4">(</span><span class="ss">simpler</span><span class="p" data-group-id="8055469588-4">)</span><span class="w">       </span><span class="err">│</span><span class="w">
                         </span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┘</span></code></pre><h3 id="hybrid-approaches" class="section-heading"><a href="#hybrid-approaches" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Hybrid Approaches</span></h3><p>Real systems often use multiple paradigms:</p><pre><code class="makeup erlang" translate="no"><span class="c1">%% Master data: Entity-centric</span><span class="w">
</span><span class="c1">%% Stream: product-SKU123 (catalog item, rarely changes)</span><span class="w">
</span><span class="c1">%% Stream: customer-C456 (profile data)</span><span class="w">

</span><span class="c1">%% Transactional processes: Process-centric</span><span class="w">
</span><span class="c1">%% Stream: order-process-ORD789 (order fulfillment)</span><span class="w">
</span><span class="c1">%% Stream: return-request-RET012 (return processing)</span><span class="w">

</span><span class="c1">%% Analytics: Tag-based queries (without DCB concurrency)</span><span class="w">
</span><span class="c1">%% Query by tags for reporting, not for consistency</span></code></pre><hr class="thin"/><h2 id="reckondb-s-position" class="section-heading"><a href="#reckondb-s-position" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">ReckonDB's Position</span></h2><p><strong>ReckonDB recommends the process-centric paradigm</strong> for most event-sourced systems because:</p><ol><li><strong>Better auditability</strong> - The dossier captures decision context</li><li><strong>Simpler implementation</strong> - No sagas, no tag indexes for concurrency</li><li><strong>Natural fit</strong> - Most business operations are processes, not entity mutations</li></ol><p>However, ReckonDB supports <strong>tags for query purposes</strong>:</p><pre><code class="makeup erlang" translate="no"><span class="c1">%% Tags for analytics, NOT for concurrency control</span><span class="w">
</span><span class="n">Event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="9989839543-1">#{</span><span class="w">
    </span><span class="ss">event_type</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ss">enrollment_completed</span><span class="p">,</span><span class="w">
    </span><span class="ss">data</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="9989839543-2">#{</span><span class="w">
        </span><span class="ss">process_id</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="9989839543-3">&lt;&lt;</span><span class="s">&quot;enrollment-req-123&quot;</span><span class="p" data-group-id="9989839543-3">&gt;&gt;</span><span class="p">,</span><span class="w">
        </span><span class="ss">student_id</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mi">456</span><span class="p">,</span><span class="w">
        </span><span class="ss">course_id</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="9989839543-4">&lt;&lt;</span><span class="s">&quot;CS101&quot;</span><span class="p" data-group-id="9989839543-4">&gt;&gt;</span><span class="w">
    </span><span class="p" data-group-id="9989839543-2">}</span><span class="p">,</span><span class="w">
    </span><span class="ss">tags</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="9989839543-5">[</span><span class="p" data-group-id="9989839543-6">&lt;&lt;</span><span class="s">&quot;student:456&quot;</span><span class="p" data-group-id="9989839543-6">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9989839543-7">&lt;&lt;</span><span class="s">&quot;course:CS101&quot;</span><span class="p" data-group-id="9989839543-7">&gt;&gt;</span><span class="p" data-group-id="9989839543-5">]</span><span class="w">  </span><span class="c1">%% For queries only</span><span class="w">
</span><span class="p" data-group-id="9989839543-1">}</span><span class="p">,</span><span class="w">

</span><span class="c1">%% Concurrency remains stream-version-based</span><span class="w">
</span><span class="p" data-group-id="9989839543-8">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="p" data-group-id="9989839543-8">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">reckon_db</span><span class="p">:</span><span class="nf">append</span><span class="p" data-group-id="9989839543-9">(</span><span class="p" data-group-id="9989839543-10">&lt;&lt;</span><span class="s">&quot;enrollment-req-123&quot;</span><span class="p" data-group-id="9989839543-10">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9989839543-11">[</span><span class="n">Event</span><span class="p" data-group-id="9989839543-11">]</span><span class="p">,</span><span class="w"> </span><span class="n">ExpectedVersion</span><span class="p" data-group-id="9989839543-9">)</span><span class="p">.</span><span class="w">

</span><span class="c1">%% But you can query across processes by tags</span><span class="w">
</span><span class="p" data-group-id="9989839543-12">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">AllStudentEnrollments</span><span class="p" data-group-id="9989839543-12">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">reckon_db</span><span class="p">:</span><span class="nf">read_by_tags</span><span class="p" data-group-id="9989839543-13">(</span><span class="p" data-group-id="9989839543-14">[</span><span class="p" data-group-id="9989839543-15">&lt;&lt;</span><span class="s">&quot;student:456&quot;</span><span class="p" data-group-id="9989839543-15">&gt;&gt;</span><span class="p" data-group-id="9989839543-14">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9989839543-16">#{</span><span class="p" data-group-id="9989839543-16">}</span><span class="p" data-group-id="9989839543-13">)</span><span class="p">.</span></code></pre><hr class="thin"/><h2 id="further-reading" class="section-heading"><a href="#further-reading" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Further Reading</span></h2><ul><li><a href="event_sourcing.html">Event Sourcing Guide</a> - Core event sourcing concepts</li><li><a href="cqrs.html">CQRS Guide</a> - Command Query Responsibility Segregation</li><li><a href="subscriptions.html">Subscriptions Guide</a> - Real-time event notifications</li><li><a href="snapshots.html">Snapshots Guide</a> - Optimizing aggregate loading</li></ul><h2 id="references-1" class="section-heading"><a href="#references-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">References</span></h2><h3 id="process-centric-dossier-model" class="section-heading"><a href="#process-centric-dossier-model" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Process-Centric / Dossier Model</span></h3><ul><li>ReckonDB documentation and this guide</li></ul><h3 id="dynamic-consistency-boundaries-dcb" class="section-heading"><a href="#dynamic-consistency-boundaries-dcb" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Dynamic Consistency Boundaries (DCB)</span></h3><ul><li><a href="https://dcb.events/">DCB.events</a> - Official DCB documentation</li><li><a href="https://sara.event-thinking.io/">Sara Pellegrini's Event Thinking</a> - &quot;Killing the Aggregate&quot; thesis</li><li><a href="https://docs.eventsourcingdb.io/blog/2025/12/15/kill-aggregate-an-interview-on-dynamic-consistency-boundaries/">Kill Aggregate? Interview</a> - Bastian Waidelich, EventSourcingDB</li><li><a href="https://www.axoniq.io/blog/dcb-in-af-5">DCB in Axon Framework 5</a> - First major framework support</li><li><a href="https://www.axoniq.io/blog/axon-server-future-proof-event-store">Axon Server 2025.1</a> - Event store with DCB</li></ul><h3 id="entity-centric-traditional" class="section-heading"><a href="#entity-centric-traditional" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Entity-Centric (Traditional)</span></h3><ul><li>Martin Fowler: <a href="https://martinfowler.com/eaaDev/EventSourcing.html">Event Sourcing</a></li><li>Greg Young: <a href="https://cqrs.files.wordpress.com/2010/11/cqrs_documents.pdf">CQRS and Event Sourcing</a></li><li>Vaughn Vernon: &quot;Implementing Domain-Driven Design&quot;</li></ul><h3 id="academic" class="section-heading"><a href="#academic" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Academic</span></h3><ul><li>Abadi: &quot;Consistency Tradeoffs in Modern Distributed Database System Design&quot;</li><li>Helland &amp; Campbell: &quot;Building on Quicksand&quot;</li></ul>

</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="changelog.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
Changelog
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="event_sourcing.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
Event Sourcing
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

          <span class="line">
            <a href="https://hex.pm/packages/reckon_db/1.1.0" class="footer-hex-package">Hex Package</a>

            <a href="https://preview.hex.pm/preview/reckon_db/1.1.0">Hex Preview</a>

              (<a href="https://preview.hex.pm/preview/reckon_db/1.1.0/show/guides/event_sourcing_paradigms.md">current file</a>)

          </span>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="reckon_db.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.38.2) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>

    </footer>
  </div>
</main>
</div>

  </body>
</html>
